[{"categories":null,"content":"JustDecrypt â€‹ ä¸€é“æ¥è‡ª2021ByteCTFçš„Cryptoï¼Œä¸»è¦è€ƒå¯Ÿäº†AES CFB MODEä»¥åŠä¸€ä¸ªä¸å®‰å…¨çš„unpad(). ğŸŒŸ0x1 Description â€‹ é¢˜ç›®æè¿°ï¼šItâ€™s just a decryption system. And I heard that only the Bytedancers can get secret. â€‹ é¢˜ç›®é™„ä»¶ï¼šJustDecrypt.py ğŸŒŸ0x2 Analysis é¢˜ç›®ä¸€å…±åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š1ï¼‰æš´åŠ›ç ´è§£HASHï¼›2ï¼‰Chosen-ciphertext-attack in AES CFB MODE ç¬¬ä¸€é˜¶æ®µçš„ä¸»è¦é€»è¾‘å®šä¹‰åœ¨ proof_of_work() æ–¹æ³•ä¸­ï¼Œ def proof_of_work(self): random.seed(urandom(32)) alphabet = string.ascii_letters + string.digits proof = ''.join(random.choices(alphabet, k=32)) hash_value = sha256(proof.encode()).hexdigest() self.send(f'sha256(XXXX+{proof[4:]}) == {hash_value}'.encode()) nonce = self.recv(prompt=b'Give me XXXX \u003e ') if len(nonce) != 4 or sha256(nonce + proof[4:].encode()).hexdigest() != hash_value: return False return True alphabetçš„é•¿åº¦ä¸º62ï¼Œè€Œæˆ‘ä»¬éœ€è¦æš´åŠ›ç ´è§£åŸæ–‡çš„å­ä¸²é•¿åº¦åªæœ‰4ï¼Œå› æ­¤å¯èƒ½çš„åŸæ–‡ä»…æœ‰ $62^4=14776336$ ç§ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨PPTå†…è§£å†³ï¼ˆå…¶å®ç›¸å½“çš„å¿«ï¼‰ Exploitä»£ç å¦‚ä¸‹ def hash_collid(tar_hash, proof_back): with open('./prefix', 'rb') as f: prefix_set = pickle.load(f) for prefix in tqdm(prefix_set): temp = prefix + proof_back if hashlib.sha256(temp.encode()).hexdigest() == tar_hash: print(red('[*]Found! ') + prefix) return prefix å…¶ä¸­é¢„å…ˆè®¡ç®—äº†æ‰€æœ‰å¯èƒ½çš„åŸæ–‡å­ä¸² ç¬¬äºŒé˜¶æ®µ challä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè§£å¯†Oracleï¼Œå¹¶ä¸”è¯¥Oracleä½¿ç”¨çš„æ˜¯AES CFB MODEï¼Œæˆ‘ä»¬éœ€è¦æ„é€ å‡ºæ°å½“çš„å¯†æ–‡ä»¥ä½¿å…¶è§£å¯†å‡ºçš„æ˜æ–‡åœ¨ unpad åä¸ºï¼šHello, I'm a Bytedancer. Please give me the flag! åœ¨paddingè¿‡ç¨‹ä¸­é‡‡ç”¨äº†ä¸PKCS #7ç›¸ä¼¼çš„ç®—æ³•ï¼Œä¸è¿‡åœ¨ unpadæ–¹æ³•ä¸­å­˜åœ¨æ¼æ´ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥è·å–Oracleè§£å¯†åçš„æ˜æ–‡ @staticmethod def unpad(s): return s[:-s[-1]] å¹¶ä¸”å‡ºäºOracleçš„è®¿é—®é™åˆ¶ï¼Œæˆ‘ä»¬ä¸å…¶äº¤äº’çš„æ¬¡æ•°æœ‰é™ï¼Œå¾ˆæœ‰å¯èƒ½ä¸èƒ½å¤Ÿåœ¨æœ‰é™çš„æ¬¡æ•°å†…è¿˜åŸå‡ºåˆæ³•paddingçš„æ˜æ–‡ï¼Œä½†åˆ©ç”¨ä¸Šè¿°æ¼æ´æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºç¬¦åˆæ¡ä»¶çš„plaintext {Hello, I'm a Bytedancer. Please give me the flag!} è€Œä¸ç”¨åˆæ³•çš„padding æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è¯¦ç»†è€ƒå¯Ÿä¸€ä¸‹AES CFB MODE ğŸŒŸAES CFB MODE â€‹ åœ¨pycryptodomeåº“ä¸­ï¼ŒAES_MODE_CFBçš„å®ç°ä¾ç…§NIST SP 800-38A, section 6.3ï¼Œå…¶å¤§è‡´çš„åŠ è§£å¯†æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ â€‹ æ•°å­¦è¡¨è¿°ä¸ºï¼š \\begin{equation} \\mathbf{E}=\\sum_{i} \\mathbf{E}_{i}=\\mathbf{E}_{1}+\\mathbf{E}_{2}+\\mathbf{E}_{3}+\\cdots \\end{equation} LSBï¼ˆleast significant bitsï¼‰æ•°äºŒè¿›åˆ¶è¡¨ç¤ºçš„ä½æ¯”ç‰¹ä½ ï¼ŒMSBï¼ˆmost significant bitsï¼‰æ•°äºŒè¿›åˆ¶è¡¨ç¤ºçš„é«˜æ¯”ç‰¹ä½ åœ¨pycryptodomeåº“ä¸­ï¼Œä½¿ç”¨AES_MODE_CFBæ„é€ Cipheræ—¶æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å‚æ•°segment_size å…¶æŒ‡ç¤ºäº†plaintextä¸ciphertextçš„segementï¼Œåœ¨Docä¸­å…¶æè¿°ä¸ºï¼Œ â€‹ segment_size (integer) â€‹ (Only MODE_CFB). The number of bits the plaintext and ciphertext are segmented in. It must be a multiple of 8. â€‹ If not specified, it will be assumed to be 8. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨AES_MODE_ECBæ¥å®ç°AES_MODE_CFBï¼Œå…·ä½“çš„å®ç°åœ¨æœ¬WPä¸­ä¸åœ¨å¤šè¿° æˆ‘ä»¬å›åˆ°challä¸­ï¼Œç”±äºè¯¥æ–¹æ¡ˆä½¿ç”¨äº†ä¸å®‰å…¨çš„unpad()æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„é€ ä¸€ä¸ªé•¿ciphertextï¼ˆè¿™é‡Œæˆ‘ç”¨äº†1024Bitï¼‰ä½¿å¾—ä¸Šè¿° $CIPH_K(I_j)$ å†…å®¹æ³„éœ²ã€‚ åˆ©ç”¨æ³„éœ²çš„ $CIPH_K(I_j)$ ä¸æˆ‘ä»¬å·²çŸ¥çš„æ˜æ–‡ä½œXORè¿ç®—ï¼Œä¾¿å¯ä»¥å¾—åˆ°å¯¹åº”çš„å¯†æ–‡ï¼Œç”±æ­¤æˆ‘ä»¬èƒ½å¤Ÿé€Byteæ¢å¤å¯†æ–‡ä¿¡æ¯ã€‚ä½†ç”±äºä¸Oracleçš„äº¤äº’æ¬¡æ•°æœ‰é™ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å¤Ÿå¾—åˆ°åˆæ³•çš„paddingåçš„æ˜æ–‡æ‰€å¯¹åº”çš„å¯†æ–‡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ©ç”¨unpad() æŒ‰ç…§ä¸Šè¿°æ–¹æ³•æ„é€ Hello, I'm a Bytedancer. Please give me the flag!å¯¹åº”çš„ciphertextï¼Œæ¥ç€åœ¨è·å¾—çš„å¯†æ–‡åæ·»åŠ '00' * 30æ¥è¦†ç›–nonceï¼Œå¾—åˆ°æˆ‘ä»¬ä¸€å¼€å§‹æ¢å¤ H æ‰€ä½¿ç”¨çš„ $CIPH_K(I_0)$ é«˜sä½ ï¼ˆåœ¨å®æ–½æ”»å‡»å‰æˆ‘ä»¬éœ€è¦ç”¨å¯†æ–‡ '00'*512 æ¥è¦†ç›–nonceä»è€Œæ§åˆ¶Decryptæµ {Cipherå†…éƒ¨çŠ¶æ€} ï¼‰ï¼Œè®¡ç®— $MSB_{s}(CIPH_K(I_{0}))\\oplus0X1F$ å…¶ä¸­0X1Fæ˜¯æˆ‘ä»¬åœ¨å¯†æ–‡åæ·»åŠ çš„Byteä¸ªæ•°ï¼Œåˆ©ç”¨ unpad() ä¸­çš„é€»è¾‘ s[:-s[-1]] æˆ‘ä»¬èƒ½å¤Ÿå»é™¤å¤šä½™å¯†æ–‡æ‰€å¸¦æ¥çš„æ‚ä¹±æ˜æ–‡ï¼Œè¿™æ ·ä¾¿èƒ½å¤ŸæˆåŠŸæ”»å‡»è¯¥å¯†ç æ–¹æ¡ˆï¼Œè·å¾—FLAGã€‚ ğŸŒŸ 0x3 EXPLOITED import hashlib from tqdm import tqdm import pickle from curtsies.fmtfuncs import red from pwn import * import codecs import binascii import re io = remote('39.105.181.182', 30001) target_plaintext = b\"Hello, I'm a Bytedancer. Please give me the flag!\" def interactive_pharse1(io): temp = io.recvuntil(b'Give me XXXX \u003e') tar_hash = temp[temp.find(b'==')+3:temp.find(b'==')+3+64].decode() proof_back = temp[temp.find(b'XXXX')+5:temp.find(b'XXXX')+5+28].decode() proof_prefix = hash_collid(tar_hash, proof_back) io.sendline(proof_prefix.encode()) return io def hash_collid(tar_hash, proof_back): with open('./prefix', 'rb') as f: prefix_set = pickle.load(f) for prefix in tqdm(prefix_set): temp = prefix + proof_back if hashlib.sha256(temp.encode()).hexdigest() == tar_hash: print(red('[*]Found! ') + prefix) return prefix def interactive_pharse2(io, cip, flag=0): io.recvuntil(b'Please enter your cipher in hex \u003e') io.sendline(cip) io.recvuntil(b' Your plaintext in hex: \\n') plaintext = io.recvuntil(b'\\n\\n') if flag == 1: io.recvuntil(b'OK! Here is your flag: ') string = io.recv().decode() print(red(\"[+] Here's the Flag: \") + re.search('ByteCTF{.*}', string).group(0)) return print(plaintext) return plaintext[:-2] def atk(io): global target_plaintext cip = [b'\\x00'] ","date":"2022-07-04","objectID":"/2021-10-20-justdecrypt/:0:1","tags":null,"title":"JustDecrypt","uri":"/2021-10-20-justdecrypt/"},{"categories":null,"content":"ğŸ˜ç®€ä»‹ å¤§ä¸‰åœ¨è¯»ä¿¡æ¯å®‰å…¨ä¸“ä¸šå­¦ç”Ÿä¸€æšï¼Œç›®å‰é™¤äº†ä¿®å­¦æ ¡çš„è¯¾ç¨‹ä¹‹ä½™è¿˜åœ¨å­¦ä¹ åˆ†å¸ƒå¼ç³»ç»Ÿå®ç°ä»¥åŠä¸äº‘åŸç”Ÿç›¸å…³çš„ä¸€ç³»åˆ—çŸ¥è¯†ï¼ŒåŒ…æ‹¬å®¹å™¨æŠ€æœ¯ã€Kuberneteså®¹å™¨ç¼–æ’å¹³å°ã€äº‘åŸç”Ÿæ¶æ„ä¸‹çš„å®‰å…¨é—®é¢˜ç°çŠ¶ä»¥åŠç¼“è§£æ–¹æ¡ˆâ€¦â€¦å› ä¸ºæœ¬å¹´åº¦è¿˜è¦å’Œé˜Ÿå‹ä»¬å‚åŠ å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›ï¼Œå› æ­¤è¿˜éœ€è¦ä¼šç”¨ç°æœ‰çš„æœºå™¨å­¦ä¹ /ç»Ÿè®¡å­¦ä¹ æ¨¡å‹å»å®Œæˆå›¢é˜Ÿä½œå“çš„è®¾è®¡å®ç°ï¼Œæ­£å¥½æœ‰æœºä¼šç³»ç»Ÿçš„æ¢³ç†ä¸€ä¸‹æœ‰å…³æœºå™¨å­¦ä¹ åœ¨åº”ç”¨å®è·µä¸Šçš„å†…å®¹ï¼Œç†è®ºç ”ç©¶é™¤äº†é˜…è¯»ç»å…¸è®ºæ–‡æœ‰ä¸€ä¸ªç²—ç•¥çš„äº†è§£å¤–åº”è¯¥ä¸ä¼šæ¶‰çŒå¤ªå¤šã€‚å…³äºä»Šå¹´çš„CTFæ¯”èµ›åº”è¯¥è¿˜æ˜¯ä¼šå°½é‡å‚åŠ çš„ï¼Œä½†ä¸»è¦è¿˜æ˜¯ä»¥å‘å¤§ä½¬å­¦ä¹ ä¸ºä¸»ï¼Œé¢˜ç›®å¤§å®¶éƒ½å°½é‡åšï¼Œèƒ½åšä¸€é¢˜æ˜¯ä¸€é¢˜ï¼Œæ‹“å±•ä¸€ä¸‹Exploitçš„æ€è·¯ä»¥åŠå¯¹ç°æœ‰è½¯ä»¶æ¶æ„åœ¨å®‰å…¨æ€§æ–¹é¢è¿›è¡Œåæ€ã€‚ä»Šå¹´æƒ³å¿…ä¹Ÿæ²¡æœ‰è¿™ä¹ˆå¤šæ—¶é—´å»çœ‹å†å²ã€å“²å­¦ã€ç¤¾ä¼šå­¦ç±»çš„ä¹¦ç±äº†ï¼Œæ¯•ç«Ÿè¿˜éœ€è€ƒè™‘å®ä¹ ä¸å‡†å¤‡TOEFLè€ƒè¯•ï¼ŒåæœŸåº”è¯¥ä¼šå¥½å¥½è·Ÿç€å¯¼å¸ˆå»å†™è®ºæ–‡åšä¸€äº›å¹³å°å±‚é¢çš„å®‰å…¨è°ƒæŸ¥ç ”ç©¶ï¼Œå¸Œæœ›èƒ½æœ‰ä¸€ä¸ªä¸é”™çš„ç»“æœã€‚ï¼šï¼‰ ","date":"0001-01-01","objectID":"/about/:0:1","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"ğŸ˜‰è”ç³»æ–¹å¼ ğŸ“¨ wgblike@outlook.com ","date":"0001-01-01","objectID":"/about/:0:2","tags":null,"title":"","uri":"/about/"}]