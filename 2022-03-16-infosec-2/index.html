<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>InfoSec-Lab2-apollo - p1nant0m</title><meta name="Description" content="p1nant0m"><meta property="og:title" content="InfoSec-Lab2-apollo" />
<meta property="og:description" content="Architecture Design æ¨¡æ‹Ÿå®ç°128ä½ä¿¡æ¯çš„åŠ å¯†é€šä¿¡è¿‡ç¨‹ã€‚ å®éªŒè®¾è®¡åŒ…å«ä¸‰æ–¹ï¼šAï¼ŒBï¼ŒCã€‚Aä¸Bä¹‹é—´è¿›è¡Œ128ä½ä¿¡æ¯çš„åŠ å¯†äº¤æ¢ã€‚Cè´Ÿè´£ä¸ºAå’ŒBå„ç”Ÿæˆä¸€å¯¹å…¬ç§é’¥å¯¹ï¼Œå¹¶åˆ†åˆ«æŠŠå¯¹åº”çš„ç§é’¥ä¼ ç»™Aå’ŒBï¼Œå¹¶æŠŠä»–ä»¬çš„å…¬é’¥å…¬å¼€ã€‚å®ç°æœ¬å®éªŒéœ€æ±‚çš„æ¶æ„è®¾è®¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ é¡¹ç›®æ•°æ®æµå›¾&#34; é¡¹ç›®æ•°æ®æµå›¾ Protocol Design åœ¨è¯¥å®éªŒéœ€æ±‚ä¸­ï¼ŒServerAä¸ServerBä¹‹é—´ä½¿ç”¨Asymmetric Encryption Schemeè¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ŒServerCå……å½“å¯†é’¥ç­¾å‘ä¸­å¿ƒï¼Œè´Ÿè´£ä¸ºS" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://p1nant0m.com/2022-03-16-infosec-2/" /><meta property="og:image" content="https://p1nant0m.com/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-16T20:00:00+00:00" />
<meta property="article:modified_time" content="2022-03-16T20:00:00+00:00" /><meta property="og:site_name" content="p1nant0m" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://p1nant0m.com/logo.png"/>

<meta name="twitter:title" content="InfoSec-Lab2-apollo"/>
<meta name="twitter:description" content="Architecture Design æ¨¡æ‹Ÿå®ç°128ä½ä¿¡æ¯çš„åŠ å¯†é€šä¿¡è¿‡ç¨‹ã€‚ å®éªŒè®¾è®¡åŒ…å«ä¸‰æ–¹ï¼šAï¼ŒBï¼ŒCã€‚Aä¸Bä¹‹é—´è¿›è¡Œ128ä½ä¿¡æ¯çš„åŠ å¯†äº¤æ¢ã€‚Cè´Ÿè´£ä¸ºAå’ŒBå„ç”Ÿæˆä¸€å¯¹å…¬ç§é’¥å¯¹ï¼Œå¹¶åˆ†åˆ«æŠŠå¯¹åº”çš„ç§é’¥ä¼ ç»™Aå’ŒBï¼Œå¹¶æŠŠä»–ä»¬çš„å…¬é’¥å…¬å¼€ã€‚å®ç°æœ¬å®éªŒéœ€æ±‚çš„æ¶æ„è®¾è®¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ é¡¹ç›®æ•°æ®æµå›¾&#34; é¡¹ç›®æ•°æ®æµå›¾ Protocol Design åœ¨è¯¥å®éªŒéœ€æ±‚ä¸­ï¼ŒServerAä¸ServerBä¹‹é—´ä½¿ç”¨Asymmetric Encryption Schemeè¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ŒServerCå……å½“å¯†é’¥ç­¾å‘ä¸­å¿ƒï¼Œè´Ÿè´£ä¸ºS"/>
<meta name="application-name" content="æˆ‘çš„ç½‘ç«™">
<meta name="apple-mobile-web-app-title" content="æˆ‘çš„ç½‘ç«™"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://p1nant0m.com/2022-03-16-infosec-2/" /><link rel="prev" href="https://p1nant0m.com/2021-12-05-chapter3/" /><link rel="next" href="https://p1nant0m.com/2022-07-18-xdp-tutorial/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "InfoSec-Lab2-apollo",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/p1nant0m.com\/2022-03-16-infosec-2\/"
        },"genre": "posts","keywords": "project","wordcount":  3974 ,
        "url": "https:\/\/p1nant0m.com\/2022-03-16-infosec-2\/","datePublished": "2022-03-16T20:00:00+00:00","dateModified": "2022-03-16T20:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "p1nant0m"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84EW6PHH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CX84EW6PHH');
    </script>
    
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="p1nant0m"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><a class="menu-item" href="/about/"> å…³äº </a><a class="menu-item" href="/friends/"> å‹é“¾ </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="é€‰æ‹©è¯­è¨€">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2022-03-16-infosec-2/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84EW6PHH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CX84EW6PHH');
    </script>

    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="p1nant0m"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="/about/" title="">å…³äº</a><a class="menu-item" href="/friends/" title="">å‹é“¾</a><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="é€‰æ‹©è¯­è¨€">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2022-03-16-infosec-2/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">InfoSec-Lab2-apollo</h1><h2 class="single-subtitle">ä¿¡æ¯å®‰å…¨æŠ€æœ¯å®éªŒè¯¾ç¨‹Lab2</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>p1nant0m</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-03-16">2022-03-16</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;çº¦ 3974 å­—&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;é¢„è®¡é˜…è¯» 8 åˆ†é’Ÿ&nbsp;<span id="/2022-03-16-infosec-2/" class="leancloud_visitors" data-flag-title="InfoSec-Lab2-apollo">
                        <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;æ¬¡é˜…è¯»
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#architecture-design">Architecture Design</a></li>
    <li><a href="#protocol-design">Protocol Design</a>
      <ul>
        <li><a href="#serverckey-distribution-center">ServerCâ€”â€”Key Distribution Center</a>
          <ul>
            <li><a href="#kdcä¸clienté—´é€šä¿¡çš„æŠ¥æ–‡æ ¼å¼"><strong>KDCä¸Clienté—´é€šä¿¡çš„æŠ¥æ–‡æ ¼å¼</strong></a></li>
          </ul>
        </li>
        <li><a href="#communication-peers">Communication Peers</a></li>
      </ul>
    </li>
    <li><a href="#implementation">Implementation</a></li>
    <li><a href="#helpful-commands">Helpful Commands</a></li>
    <li><a href="#chatting">Chatting</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="architecture-design">Architecture Design</h2>
<p>æ¨¡æ‹Ÿå®ç°128ä½ä¿¡æ¯çš„åŠ å¯†é€šä¿¡è¿‡ç¨‹ã€‚</p>
<p>å®éªŒè®¾è®¡åŒ…å«ä¸‰æ–¹ï¼šAï¼ŒBï¼ŒCã€‚Aä¸Bä¹‹é—´è¿›è¡Œ128ä½ä¿¡æ¯çš„åŠ å¯†äº¤æ¢ã€‚Cè´Ÿè´£ä¸ºAå’ŒBå„ç”Ÿæˆä¸€å¯¹å…¬ç§é’¥å¯¹ï¼Œå¹¶åˆ†åˆ«æŠŠå¯¹åº”çš„ç§é’¥ä¼ ç»™Aå’ŒBï¼Œå¹¶æŠŠä»–ä»¬çš„å…¬é’¥å…¬å¼€ã€‚å®ç°æœ¬å®éªŒéœ€æ±‚çš„æ¶æ„è®¾è®¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg" title="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg" data-thumbnail="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg" data-sub-html="<h2>é¡¹ç›®æ•°æ®æµå›¾</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg"
            data-srcset="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg, https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg 1.5x, https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.jpg" />
    </a><figcaption class="image-caption">é¡¹ç›®æ•°æ®æµå›¾</figcaption>
    </figure>
<h2 id="protocol-design">Protocol Design</h2>
<p>åœ¨è¯¥å®éªŒéœ€æ±‚ä¸­ï¼ŒServerAä¸ServerBä¹‹é—´ä½¿ç”¨Asymmetric Encryption Schemeè¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ŒServerCå……å½“å¯†é’¥ç­¾å‘ä¸­å¿ƒï¼Œè´Ÿè´£ä¸ºServerAä¸ServerBç”Ÿæˆå…¬ç§é’¥å¯¹ï¼Œå¹¶å°†ç§é’¥åˆ†å‘ç»™å¯¹åº”çš„Clientã€‚ServerAä¸ServerBçš„åœ°ä½æ˜¯ç­‰ä»·çš„ï¼Œéƒ½æ˜¯å¸Œæœ›è¿›è¡ŒåŠ å¯†é€šä¿¡çš„å¯¹ç­‰ä¸»ä½“ï¼Œä¹Ÿéƒ½æ˜¯å‘KDCç”³è¯·å¯†é’¥çš„ä¸»ä½“ï¼Œåœ¨ä¸‹è¿°åˆ†æè¿‡ç¨‹ä¸­ä¸å†åŒºåˆ†ServerAä¸ServerBï¼Œæˆ‘ä»¬ç»Ÿç§°ä¸ºé€šä¿¡æ–¹ã€‚</p>
<h3 id="serverckey-distribution-center">ServerCâ€”â€”Key Distribution Center</h3>
<p>ServerCä¸­KDCçš„å¸¸é©»å®ˆæŠ¤è¿›ç¨‹ç›‘å¬æ¥è‡ª<code>443</code>ç«¯å£çš„è¯·æ±‚ï¼Œè´Ÿè´£ä¸ºåˆ°è®¿çš„Clientç­¾å‘å…¬ç§é’¥å¯¹ï¼Œå¹¶ä¸ºå…¶æä¾›å…¶æ‰€æƒ³è¦è¿›è¡ŒåŠ å¯†é€šä¿¡æ–¹çš„ç½‘ç»œåœ°å€ä»¥åŠè¯¥ä¸»ä½“å¯¹åº”çš„å…¬é’¥ã€‚</p>
<ul>
<li>é›†ç¾¤ä¸­æ‰€æœ‰ä¸»ä½“åœ¨è¿›è¡ŒåŠ å¯†é€šä¿¡ä¹‹å‰éƒ½éœ€è¦å…ˆåœ¨KDCä¸­è¿›è¡Œæ³¨å†Œã€‚KDCä¼šä¸ºå‘èµ·è¯·æ±‚çš„Clientç­¾å‘ä¸€å¯¹å…¬ç§é’¥å¹¶è®°å½•ä¸‹è¯¥Clientä¿¡æ¯æ¥æ”¶ç«¯çš„ç½‘ç»œåœ°å€ä¿¡æ¯ä¸å…¶å¯¹åº”çš„å…¬é’¥ä¿¡æ¯ã€‚</li>
<li>è¯¥æ³¨å†Œè¿‡ç¨‹æˆ‘ä»¬å‡è®¾æ˜¯åœ¨é«˜æƒé™å®‰å…¨ç¯å¢ƒä¸‹è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯æ„å‘³ç€èƒ½å¤Ÿè¿›è¡Œæ³¨å†Œçš„ç”¨æˆ·éƒ½æ˜¯åˆæ³•çš„ã€‚</li>
<li>KDCä¸Clientä¹‹é—´é€šä¿¡åŸºäºTLSï¼ˆæˆ–ä½¿ç”¨åè®®ä¸€ä¸­çš„è®¤è¯å¯†é’¥äº¤æ¢æ–¹æ¡ˆå»ºç«‹ä¼šè¯å¯†é’¥ï¼‰ï¼Œå› æ­¤KDCå‘Clientå‘é€çš„ç§é’¥æ•æ„Ÿä¿¡æ¯æ˜¯å—åˆ°ä¿æŠ¤çš„ã€‚</li>
<li>KDCå‡è®¾æ‰€æœ‰çš„Clientéƒ½èƒ½å¤Ÿä¿å­˜å¥½è‡ªå·±è¢«åˆ†é…çš„ç§é’¥ï¼Œè‹¥ç§é’¥é—å¤±åˆ™æ— æ³•ä»Clientç«¯å‘èµ·é‡ç½®å¯†é’¥çš„è¯·æ±‚ï¼ˆæ— æ³•éªŒè¯Clientèº«ä»½ï¼‰ï¼Œæ­¤æ—¶å¿…é¡»è”ç³»KDCç®¡ç†å‘˜ç”³è¯·é‡ç½®å¯†é’¥ã€‚</li>
<li>æ‹¥æœ‰åˆæ³•ç§é’¥çš„Clientå¯ä»¥å‘KDCå‘èµ·é‡ç½®å¯†é’¥è¯·æ±‚ï¼Œä½†æ˜¯è¿™å¹¶ä¸è¢«æ¨èã€‚å› ä¸ºå…¶å®ƒçš„Clientåœ¨æœ¬åœ°ç¼“å­˜äº†å¯¹ç­‰æ–¹çš„å…¬é’¥ï¼Œè¿™ä¸ªå…¬é’¥åœ¨è¿™æ—¶å·²ç»å¤±æ•ˆäº†ã€‚æ­¤æ—¶å®ƒéœ€è¦é‡æ–°è®¿é—®KDCè·å–å…¶æœ€æ–°çš„å…¬é’¥ï¼Œä»¥å®ç°ä¸è¯¥Clientçš„åŠ å¯†é€šä¿¡ã€‚</li>
<li>KDCä½¿ç”¨è‡ªç­¾åè¯ä¹¦æ¥è¯ä¹¦è‡ªå·±çš„åˆæ³•èº«ä»½ï¼Œåœ¨æœ¬æ¬¡å®éªŒä¸­ä¸ºäº†æ–¹ä¾¿èµ·è§å°±ä¸å°†è¯¥è‡ªç­¾åè¯ä¹¦æ·»åŠ è‡³ç³»ç»Ÿè¯ä¹¦æ ¹ä¿¡ä»»é“¾ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨å®¢æˆ·ç«¯ä¸­è®¾ç½®<code>InsecureSkipVerify: true</code> æ¥å…é™¤ç³»ç»Ÿå¯¹è¯ä¹¦çš„æ ¡éªŒã€‚</li>
</ul>
<h4 id="kdcä¸clienté—´é€šä¿¡çš„æŠ¥æ–‡æ ¼å¼"><strong>KDCä¸Clienté—´é€šä¿¡çš„æŠ¥æ–‡æ ¼å¼</strong></h4>
<p>Client è¯·æ±‚æŠ¥æ–‡ (å‘KDCæ³¨å†Œè‡ªèº«)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">[0x00-0x01] Action (0x01) å‘KDCè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¯·æ±‚æ³¨å†ŒæŠ¥æ–‡

[0x01-0x0b] ClientName_Hasing_Hex_Truncated_10

[0x0b-0x1f] padding_receiverAddr

[0x1f-0x24] padding_receiverPort

[0x24-0x25] EOF Bytes (0x00)
</code></pre></td></tr></table>
</div>
</div><p>KDCå“åº”æŠ¥æ–‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">[0x00-0x80] PrivateKey
</code></pre></td></tr></table>
</div>
</div><p>Clientè¯·æ±‚æŠ¥æ–‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">[0x00-0x01] Action (0x02) å‘KDCè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¯·æ±‚è·å–é€šä¿¡æ–¹å…¬é’¥ä¸ç½‘ç»œåœ°å€ä¿¡æ¯çš„æŠ¥æ–‡

[0x01-0x0b] ClientName_Hasing_Hex_Truncated_10

[0x01-0x15] RemoteServer_Hasing_Hex_Truncated_10

[0x15-0x35] Signature of ClientName_Hasing _Hex_Truncated_10
</code></pre></td></tr></table>
</div>
</div><p>KDCå“åº”æŠ¥æ–‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">[0x00-0x01] ValidMark (0x01è¡¨ç¤ºè¯·æ±‚Clientä¸å…¶æƒ³è¦è¿›è¡Œé€šä¿¡çš„å¯¹è±¡å·²ç»åœ¨KDCæ³¨å†Œå¹¶ä¸”ç­¾åé€šè¿‡éªŒè¯)

[0x01-0x15] TargetServer.receiverAddr **Padding**

[0x15-0x1a] targetServer.receiverPort **Padding**

[0x1a-0x9a] TargetServer.receiverPublicKey
</code></pre></td></tr></table>
</div>
</div><h3 id="communication-peers">Communication Peers</h3>
<p>åœ¨æœ¬å®éªŒéœ€æ±‚ä¸­ï¼ŒServerAä¸ServerBéƒ½æ˜¯å¸Œæœ›è¿›è¡ŒåŠ å¯†é€šä¿¡çš„ä¸»ä½“ï¼Œå®ƒä»¬å‘KDCæ³¨å†Œè‡ªèº«å¹¶é€šè¿‡KDCå‘ç°å…¶å®ƒåŒåƒšã€‚ç°ä»¥ServerAæƒ³è¦å‘ServerBå‘èµ·ä¸€æ¬¡åŠ å¯†é€šä¿¡çš„è¿‡ç¨‹ä¸ºä¾‹ï¼Œè®²è§£æœ¬å®éªŒè®¾è®¡ã€‚</p>
<p>ServerAè‹¥æƒ³è¦ä¸ServerBè¿›è¡Œé€šä¿¡ï¼Œå°±å¿…é¡»åœ¨KDCä¸­æ³¨å†Œè‡ªèº«ï¼ŒåŒç†ï¼ŒServerBä¹Ÿéœ€è¦åœ¨KDCä¸­æ³¨å†Œè‡ªèº«ï¼Œè¿™æ ·ServerAä¸ServerBå°±åŠ å…¥äº†è¿™ä¸ªé›†ç¾¤ä¹‹ä¸­ã€‚</p>
<ul>
<li>ServerAé€šè¿‡TLSåŠ å¯†ä¿æŠ¤çš„ä¿¡é“æ¥æ”¶ç”±KDCç”Ÿæˆçš„ç§é’¥å¹¶å°†å…¶ä¿å­˜è‡³æœ¬åœ°ã€‚</li>
<li>ServerAäº‹å…ˆçŸ¥é“ServerBåœ¨è¿™ä¸ªé›†ç¾¤ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆIdentificationï¼‰ã€‚é€šè¿‡è¿™ä¸ªæ ‡è¯†ç¬¦ï¼ŒServerAèƒ½å¤Ÿå‘KDCå‘èµ·ä¸€æ¬¡è¯¢é—®ï¼Œè¯·æ±‚ServerBæ‰€åœ¨çš„ç½‘ç»œåœ°å€ã€ServerBä¿¡æ¯æ¥æ”¶ç«¯æ‰€ç›‘å¬çš„ç«¯å£ä»¥åŠServerBçš„å…¬é’¥ç­‰ç›¸å…³ä¿¡æ¯ã€‚äºæ­¤åŒæ—¶ï¼ŒServerAå‘KDCå‘é€çš„æŠ¥æ–‡ä¸­æºå¸¦äº†ServerAå¯¹å…¶Identificationçš„ç­¾åç”¨ä»¥è¯æ˜å®ƒæ˜¯è¯¥é›†ç¾¤ä¸­çš„åˆæ³•æˆå‘˜ã€‚</li>
<li>ServerAè‹¥èƒ½å¤Ÿé€šè¿‡KDCçš„éªŒè¯åˆ™ä¼šæ”¶åˆ°æ¥è‡ªKDCçš„å“åº”ã€‚è¯¥å“åº”æŠ¥æ–‡ä¸­åŒ…å«äº†ServerBçš„ç½‘ç»œåœ°å€ä»¥åŠå…¶å…¬é’¥ç­‰ä¿¡æ¯ã€‚</li>
<li>ServerAåˆ©ç”¨ServerBçš„ç½‘ç»œåœ°å€å‘å…¶å‘èµ·ä¸€æ¬¡TCPè¿æ¥ï¼Œå¯ä»¥æ³¨æ„åˆ°è¯¥TCPè¿æ¥å¹¶æ²¡æœ‰ä½¿ç”¨TLSè¿›è¡Œä¿æŠ¤ï¼Œæ‰€æœ‰åœ¨è¿™ä¸ªè¿æ¥ä¸­ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªç»åŠ å¯†çš„ã€‚</li>
<li>ServerAä½¿ç”¨ServerBçš„å…¬é’¥å¯¹å…¶è¦å‘é€ç»™ServerBçš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„æ•°æ®æ¨å…¥TCPå»ºç«‹çš„ä¿¡é“ä¹‹ä¸­ã€‚</li>
<li>ServerBç›‘å¬åˆ°æ¥è‡ªServerAçš„è¿æ¥è¯·æ±‚ï¼Œä¸ServerAå»ºç«‹èµ·TCPè¿æ¥ï¼Œå¹¶æ¥æ”¶ç”±ServerAä¸­ä¼ è¾“è¿‡æ¥çš„åŠ å¯†æ•°æ®</li>
<li>ServerBä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æ¥è‡ªServerAçš„åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å°†è§£å¯†åçš„æ˜æ–‡å†™å…¥æ–‡ä»¶å’Œæ ‡å‡†è¾“å‡ºæµä¸­ï¼ˆå†™å…¥æ–‡ä»¶ä¸­çš„æ•°æ®ä»¥16è¿›åˆ¶çš„å½¢å¼è¡¨ç¤ºï¼Œè‡³äºè¾“å‡ºæµä¸­çš„æ•°æ®æ˜¯è½¬æ¢ä¸ºASCIIå­—ç¬¦åè¿›è¡Œå±•ç¤ºï¼Œæˆ‘ä»¬è¿™é‡Œå‡è®¾ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ï¼‰</li>
<li>è¿™æ ·ServerAä¸ServerBä¹‹é—´ä¸€æ¬¡åŠ å¯†é€šä¿¡è¿‡ç¨‹å°±å®Œæˆäº†ã€‚</li>
</ul>
<h2 id="implementation">Implementation</h2>
<p>æœ¬å®éªŒåŸºäºGolang Cobraæ¡†æ¶å®ç°äº†ä¸€ä¸ªCLIåº”ç”¨ï¼Œå…·ä½“çš„ä»£ç å¯å‚è€ƒä»“åº“ã€‚è¿™é‡Œä»…ç»™å‡ºä½¿ç”¨æœ¬CLIåº”ç”¨è¿›è¡ŒServerAä¸ServerBåŠ å¯†é€šä¿¡ï¼Œä»¥åŠKDCå¯†é’¥ç­¾å‘çš„è¿‡ç¨‹ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¯åŠ¨KDCçš„å®ˆæŠ¤è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹åœ¨443ç«¯å£ç›‘å¬æ¥è‡ªClientçš„è¯·æ±‚ï¼Œä¸ºå®¢æˆ·ç«¯æä¾›å¯†é’¥ç­¾å‘æ³¨å†Œä»¥åŠè¿œç¨‹æœåŠ¡å™¨å‘ç°çš„æœåŠ¡ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤ï¼š<code>sudo ./kdc</code> å¯åŠ¨KDCæœåŠ¡ï¼Œç›‘å¬443ç«¯å£ã€‚</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image-20220315221341126.png" title="https://image.p1nant0m.com/image-20220315221341126.png" data-thumbnail="https://image.p1nant0m.com/image-20220315221341126.png" data-sub-html="<h2>å¯åŠ¨ KDC æœåŠ¡</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image-20220315221341126.png"
            data-srcset="https://image.p1nant0m.com/image-20220315221341126.png, https://image.p1nant0m.com/image-20220315221341126.png 1.5x, https://image.p1nant0m.com/image-20220315221341126.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image-20220315221341126.png" />
    </a><figcaption class="image-caption">å¯åŠ¨ KDC æœåŠ¡</figcaption>
    </figure>
<p>ä½¿ç”¨å‘½ä»¤ï¼š<code>./apollo regist -k localhost -l 443 -t localhost -p 7070 -n serverA -f privateK_A.key </code> å‘KDCå‘èµ·æ³¨å†Œè¯·æ±‚ï¼Œå…¶ä¸­<code>-k</code> è¡¨ç¤ºKDCçš„<code>Hostname</code> ï¼›<code>-l</code> è¡¨ç¤ºKDCæœåŠ¡çš„ç›‘å¬ç«¯å£ï¼›<code>-t</code> è¡¨ç¤ºServerA Receiverçš„<code>Hostname</code> ï¼›<code>-p</code> è¡¨ç¤ºServerA ReceiveræœåŠ¡çš„ç›‘å¬ç«¯å£ï¼›<code>-n</code> è¡¨è¿°ServerAåœ¨é›†ç¾¤ä¸­çš„æ ‡è¯†ç¬¦ï¼›<code>-f</code> è¡¨è¿°å­˜å‚¨KDCç­¾å‘ç§é’¥çš„æ–‡ä»¶è·¯å¾„ã€‚</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_1_1.png" title="https://image.p1nant0m.com/image_1_1.png" data-thumbnail="https://image.p1nant0m.com/image_1_1.png" data-sub-html="<h2>å‘KDCå‘èµ·æ³¨å†Œè¯·æ±‚</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_1_1.png"
            data-srcset="https://image.p1nant0m.com/image_1_1.png, https://image.p1nant0m.com/image_1_1.png 1.5x, https://image.p1nant0m.com/image_1_1.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_1_1.png" />
    </a><figcaption class="image-caption">å‘KDCå‘èµ·æ³¨å†Œè¯·æ±‚</figcaption>
    </figure>
<p>åŒç†ï¼Œä½¿ç”¨å‘½ä»¤ï¼š<code>./apollo regist -k localhost -l 443 -t localhost -p 7071 -n serverB -f privateK_B.key</code> å‘KDCæ³¨å†ŒServerBã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨KDCè¾“å‡ºçš„æ—¥å¿—ä¸­çœ‹åˆ°ç›¸å…³çš„æ³¨å†Œä¿¡æ¯ï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_22.png" title="https://image.p1nant0m.com/image_22.png" data-thumbnail="https://image.p1nant0m.com/image_22.png" data-sub-html="<h2>åœ¨KDCè¾“å‡ºçš„æ—¥å¿—ä¸­æŸ¥çœ‹ç›¸å…³çš„æ³¨å†Œä¿¡æ¯</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_22.png"
            data-srcset="https://image.p1nant0m.com/image_22.png, https://image.p1nant0m.com/image_22.png 1.5x, https://image.p1nant0m.com/image_22.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_22.png" />
    </a><figcaption class="image-caption">åœ¨KDCè¾“å‡ºçš„æ—¥å¿—ä¸­æŸ¥çœ‹ç›¸å…³çš„æ³¨å†Œä¿¡æ¯</figcaption>
    </figure>
<p>ç´§æ¥ç€æˆ‘ä»¬ä»¤ServerAå‘KDCè·å–ServerBçš„ç½‘ç»œåœ°å€ä¿¡æ¯ä»¥åŠå…¬é’¥ï¼Œä½¿ç”¨å‘½ä»¤ï¼š<code>./apollo getremote --cn serverA -r serverB -f remote_B -p ./privateK_A.key</code> ã€‚å…¶ä¸­ï¼Œ<code>--cn</code> è¡¨ç¤ºå½“å‰Clientåœ¨é›†ç¾¤ä¸­çš„æ ‡è¯†ç¬¦ï¼Œ<code>-r</code> æ ‡è¯†ServerAæƒ³è¦è¯·æ±‚çš„ServerBåœ¨é›†ç¾¤ä¸­çš„æ ‡è¯†ç¬¦ï¼Œ<code>-f</code> è¡¨ç¤ºè‹¥KDCæˆåŠŸéªŒè¯ServerAçš„åˆæ³•æ€§è¿”å›çš„ServerBç½‘ç»œåœ°å€ä»¥åŠå…¬é’¥ä¿¡æ¯ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ï¼Œ<code>-p</code> è¡¨ç¤ºServerAå¯¹åº”çš„ç§é’¥æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºå¯¹äºå”¯ä¸€æ ‡è¯†è¿›è¡Œç­¾åï¼Œè¡¨æ˜ServerAçš„åˆæ³•æ€§ã€‚è¯¥å‘½ä»¤çš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_33.png" title="https://image.p1nant0m.com/image_33.png" data-thumbnail="https://image.p1nant0m.com/image_33.png" data-sub-html="<h2>ServerAå‘KDCè·å–ServerBçš„ç½‘ç»œåœ°å€ä¿¡æ¯ä»¥åŠå…¬é’¥</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_33.png"
            data-srcset="https://image.p1nant0m.com/image_33.png, https://image.p1nant0m.com/image_33.png 1.5x, https://image.p1nant0m.com/image_33.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_33.png" />
    </a><figcaption class="image-caption">ServerAå‘KDCè·å–ServerBçš„ç½‘ç»œåœ°å€ä¿¡æ¯ä»¥åŠå…¬é’¥</figcaption>
    </figure>
<p>åˆ©ç”¨ä¸Šè¿°è¿‡ç¨‹è·å–åˆ°çš„ä¿¡æ¯ï¼ŒServerAä¸ServerBå·²ç»èƒ½å¤Ÿè¿›è¡Œé€šä¿¡äº†ï¼Œé¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶<code>helloB</code> å¹¶åœ¨å…¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_44.png" title="https://image.p1nant0m.com/image_44.png" data-thumbnail="https://image.p1nant0m.com/image_44.png" data-sub-html="<h2>å‘å¾…å‘é€æ–‡ä»¶å†™å…¥å†…å®¹</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_44.png"
            data-srcset="https://image.p1nant0m.com/image_44.png, https://image.p1nant0m.com/image_44.png 1.5x, https://image.p1nant0m.com/image_44.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_44.png" />
    </a><figcaption class="image-caption">å‘å¾…å‘é€æ–‡ä»¶å†™å…¥å†…å®¹</figcaption>
    </figure>
<p>ä½¿ç”¨å‘½ä»¤ï¼š<code>./apollo setupreceiver --privk-file=privateK_B.key --listen-port=7071</code> å¼€å¯ServerB ReceiveræœåŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_55.png" title="https://image.p1nant0m.com/image_55.png" data-thumbnail="https://image.p1nant0m.com/image_55.png" data-sub-html="<h2>å¼€å¯ServerB ReceiveræœåŠ¡</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_55.png"
            data-srcset="https://image.p1nant0m.com/image_55.png, https://image.p1nant0m.com/image_55.png 1.5x, https://image.p1nant0m.com/image_55.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_55.png" />
    </a><figcaption class="image-caption">å¼€å¯ServerB ReceiveræœåŠ¡</figcaption>
    </figure>
<p>ä½¿ç”¨å‘½ä»¤ï¼š<code>./apollo send --remote-info=./remote_B --sending-file=./helloB</code> å‘ServerB Receiverå‘é€åŠ å¯†æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_66.png" title="https://image.p1nant0m.com/image_66.png" data-thumbnail="https://image.p1nant0m.com/image_66.png" data-sub-html="<h2>å‘ServerB Receiverå‘é€åŠ å¯†æ•°æ®</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_66.png"
            data-srcset="https://image.p1nant0m.com/image_66.png, https://image.p1nant0m.com/image_66.png 1.5x, https://image.p1nant0m.com/image_66.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_66.png" />
    </a><figcaption class="image-caption">å‘ServerB Receiverå‘é€åŠ å¯†æ•°æ®</figcaption>
    </figure>
<p>åœ¨ ServerB Receiver ç«¯æˆ‘ä»¬å¯ä»¥çœ‹è§è§£å¯†åçš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼Œ</p>
<figure><a class="lightgallery" href="https://image.p1nant0m.com/image_77.png" title="https://image.p1nant0m.com/image_77.png" data-thumbnail="https://image.p1nant0m.com/image_77.png" data-sub-html="<h2>åœ¨ ServerB Receiver ç«¯ æŸ¥çœ‹è§£å¯†åçš„å†…å®¹</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://image.p1nant0m.com/image_77.png"
            data-srcset="https://image.p1nant0m.com/image_77.png, https://image.p1nant0m.com/image_77.png 1.5x, https://image.p1nant0m.com/image_77.png 2x"
            data-sizes="auto"
            alt="https://image.p1nant0m.com/image_77.png" />
    </a><figcaption class="image-caption">åœ¨ ServerB Receiver ç«¯ æŸ¥çœ‹è§£å¯†åçš„å†…å®¹</figcaption>
    </figure>
<p>è‡³æ­¤æˆ‘ä»¬ä¾¿å®Œæˆäº†ServerAä¸ServerBä¾é KDCçš„å¯†é’¥åˆ†å‘ä¸æœåŠ¡å‘ç°å®ç°åˆ©ç”¨Asymmetric Encryption Schemeè¿›è¡ŒåŠ å¯†é€šä¿¡çš„éœ€æ±‚ã€‚</p>
<h2 id="helpful-commands">Helpful Commands</h2>
<p><strong>Openssl Usage</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash"><span class="c1"># TLS Client tools</span>
openssl s_client -connect localhost:443

<span class="c1"># generate a private key with the correct length</span>
openssl genrsa -out server.key <span class="m">2048</span>

<span class="c1"># optional: create a self-signed certificate</span>
openssl req -new -x509 -key server.key -out server.pem -days <span class="m">3650</span>

</code></pre></td></tr></table>
</div>
</div><p><strong>RegistA</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">./apollo regist -k localhost -l <span class="m">443</span> -t localhost -p <span class="m">7070</span> -n serverA -f privateK_A.key
</code></pre></td></tr></table>
</div>
</div><p><strong>RegistB</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">./apollo regist -k localhost -l <span class="m">443</span> -t localhost -p <span class="m">7071</span> -n serverB -f privateK_B.key
</code></pre></td></tr></table>
</div>
</div><p><strong>GetRemoteInfo</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">./apollo getremote --cn serverA -r serverB -f remote_B -p ./privateK_A.key
</code></pre></td></tr></table>
</div>
</div><p><strong>Send</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">./apollo send --remote-info<span class="o">=</span>./remote_B --sending-file<span class="o">=</span>./helloB
</code></pre></td></tr></table>
</div>
</div><p><strong>Setupreceiver</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Bash" data-lang="Bash">./apollo setupreceiver --privk-file<span class="o">=</span>privateK_B.key --listen-port<span class="o">=</span><span class="m">7071</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="chatting">Chatting</h2>
<p>è¿™ä¸ªå®éªŒçš„è®¾ç½®ç¡®å®æœ‰ç‚¹ä¸€å¤´é›¾æ°´ã€‚ä½ æ—¢ç„¶é€‰æ‹©å®ç°ä¸€ä¸ªKDCï¼ˆKey Distribution Centerï¼‰ä½œä¸ºä¸€ä¸ªå¯†é’¥ç­¾å‘ä¸ç®¡ç†ä¸­å¿ƒï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¿™æ˜¯ä¸€ä¸ªä¸­å¿ƒåŒ–çš„å¯†é’¥ç®¡ç†å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦é€‰æ‹©Asymmetric Encryption Schemeå»åšå‘¢ï¼Ÿä½œä¸ºKDCåº”è¯¥å»å®ç°Symmetric Encryption Schemeä¸ºEnd-to-Endæä¾›ä¼šè¯å¯†é’¥ä¸å­˜å‚¨æœåŠ¡ï¼Œå½“ç”¨æˆ·Aéœ€è¦ä¸ç”¨æˆ·Bè¿›è¡ŒåŠ å¯†é€šä¿¡æ—¶ï¼ŒKDCåº”è¯¥ä¸ºè¿™ä¸¤ä¸ªç”¨æˆ·ç”Ÿæˆè¿™æ ·ä¸€ä¸ªå¯†é’¥å¹¶ä¸ºä»–ä»¬ç»´æŠ¤è¿™æ ·ä¸€ä¸ªå¯†é’¥ã€‚å½“ç„¶è¿™é‡Œç®€åŒ–äº†KDCä¸ç”¨æˆ·è¿›è¡Œäº¤äº’æˆæƒè®¤è¯çš„è¿‡ç¨‹ï¼Œå…·ä½“çš„å¯ä»¥å‚è€ƒ<a href="https://web.mit.edu/kerberos/#what_is" target="_blank" rel="noopener noreffer ">kerberos</a>åè®®ã€‚</p>
<p>å†è€…ä½¿ç”¨Asymmetric Encryption Schemeå»åŠ å¯†æ•°æ®æ•ˆç‡æ˜¯ä¸é«˜çš„ï¼Œå¹¶ä¸”å¯¹äºæ•°æ®é‡è¾ƒå¤§çš„åœºæ™¯æ¥è¯´åŸç”Ÿçš„åŠ å¯†æ–¹æ¡ˆå°†æ— æ³•ä½¿ç”¨ï¼ˆæ¯”å¦‚RSAæ–¹æ¡ˆä¸­ï¼Œæ‰€åŠ å¯†çš„æ•°æ®å¿…é¡»èƒ½å¤Ÿæ˜ å°„åˆ°æ‰€ä½¿ç”¨çš„ç¾¤ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼‰Asymmetric Encryption Schemeæœ€å…¸å‹çš„åº”ç”¨åœºæ™¯æ˜¯æ•°å­—ç­¾åå’Œå¯†é’¥äº¤æ¢ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åœ¨æœ¬å®éªŒçš„åœºæ™¯ä¹‹ä¸‹ï¼Œå°†ServerCç›´æ¥ç§»é™¤ï¼Œä»…ä¾é ServerAä¸ServerBå°±å¯ä»¥å®ç°åŠ å¯†é€šä¿¡ã€‚ServerAä¸ServerBå¯ä»¥ä½¿ç”¨DHKEæ–¹æ¡ˆå»ä¸ºé€šä¿¡åŒæ–¹åœ¨å…¬å¼€ä¿¡é“ä¸‹ç”Ÿæˆä¸€ä¸ªâ€œç§˜å¯†â€ï¼Œå°†è¯¥â€œç§˜å¯†â€ç»è¿‡sha256æ•£åˆ—ä¹‹åä½œä¸ºAES_GCMçš„å¯†é’¥ï¼Œä½¿ç”¨Symmetric Encryption Schemeå»å®ç°åŒæ–¹çš„åŠ å¯†é€šä¿¡ã€‚è¿™ä¾¿æ˜¯TLS/SSLçš„é«˜åº¦ç®€åŒ–ç‰ˆæœ¬ï¼Œæœ‰å…³TLS/SSLçš„è§„èŒƒå¯ä»¥<a href="https://datatracker.ietf.org/doc/html/rfc5246" target="_blank" rel="noopener noreffer ">ç‚¹å‡»è¿™é‡Œ</a>ã€‚</p>
<blockquote>
<p>A typical operation with a KDC involves a request from a user to use some service. The KDC will use cryptographic techniques to authenticate requesting users as themselves. It will also check whether an individual user has the right to access the service requested. If the authenticated user meets all prescribed conditions, the KDC can issue a ticket permitting access.</p>
<p>KDCs mostly operate with <a href="https://en.wikipedia.org/wiki/Symmetric_encryption" target="_blank" rel="noopener noreffer ">symmetric encryption</a>.</p>
<p>&ndash; From WiKi</p>
</blockquote>
<p>åæ§½å½’åæ§½ï¼Œæœ¬å®éªŒåˆšå¥½è®©æˆ‘å®è·µä¸€ä¸‹åˆšåˆšæ¥è§¦çš„Cobraæ¡†æ¶ï¼Œè™½ç„¶ç”¨åˆ°çš„ä¸œè¥¿ä¸å¤šï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿä¸å¤Ÿä¼˜é›…ï¼Œå¯èƒ½è¿˜æœ‰äº›å‡Œä¹±ï¼Œä½†èƒ½è¿›è¡Œä¸€æ¬¡å®è·µç»ˆå½’æ˜¯æœ‰è£¨ç›Šçš„ã€‚å®³ï¼Œä¸çŸ¥ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿå°†6.824çš„Raft K/Vå†™å®Œå‘¢ï¼Ÿ</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2022-03-16</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/2022-03-16-infosec-2/index.md" target="_blank">é˜…è¯»åŸå§‹æ–‡æ¡£</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://p1nant0m.com/2022-03-16-infosec-2/" data-title="InfoSec-Lab2-apollo" data-via="p1nant0m" data-hashtags="project"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://p1nant0m.com/2022-03-16-infosec-2/" data-hashtag="project"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Hacker News" data-sharer="hackernews" data-url="https://p1nant0m.com/2022-03-16-infosec-2/" data-title="InfoSec-Lab2-apollo"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://p1nant0m.com/2022-03-16-infosec-2/" data-title="InfoSec-Lab2-apollo"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://p1nant0m.com/2022-03-16-infosec-2/" data-title="InfoSec-Lab2-apollo"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/project/">project</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2021-12-05-chapter3/" class="prev" rel="prev" title="Â·å¯†ç å­¦åŸç†è¯¾ç¨‹ â€”â€” Private-Key Cryptography â… "><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Â·å¯†ç å­¦åŸç†è¯¾ç¨‹ â€”â€” Private-Key Cryptography â… </a>
            <a href="/2022-07-18-xdp-tutorial/" class="next" rel="next" title="XDP-tutorial å­¦ä¹ å¦‚ä½•ç¼–å†™ eBPF XDP ç¨‹åº">XDP-tutorial å­¦ä¹ å¦‚ä½•ç¼–å†™ eBPF XDP ç¨‹åº<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.91.2">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">p1nant0m</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/valine/Valine.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":50},"comment":{"valine":{"appId":"UnWumtTxnhlvaMmfKV6lZwUy-gzGzoHsz","appKey":"egg4vgYXZCZTW8f4QbS5bDpL","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-CN","pageSize":10,"placeholder":"ä½ çš„è¯„è®º ...","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒ."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"ğŸ™‚P1nant0m","id-2":"ğŸ™‚P1nant0m"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
