<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds - p1nant0m</title><meta name="Description" content="p1nant0m"><meta property="og:title" content="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds" />
<meta property="og:description" content="ÊúÄËøëÂú®Â≠¶‰π†‰∫ëÂéüÁîüÊúÄ‰Ω≥ÂÆâÂÖ®ÂÆûË∑µÔºåÂÖ∂‰∏≠ÊèêÂà∞‰∫Ü k8s ‰∏≠ÁöÑËÆ§ËØÅ‰∏éÊéàÊùÉÊ®°ÂùóÔºå‰∏∫‰∫ÜÂä†Ê∑±ÁêÜËß£‰ª•ÂèäÊúâÂØπ k8s Ê∫êÁ†ÅÈòÖËØªÁöÑËÆ°ÂàíÔºå‰æøËØûÁîü‰∫ÜËøô‰∏™[‚ú®Êé¢Á¥¢Á≥ªÂàó]„ÄÇÊàë‰ª¨Â∞Ü‰ªéÈúÄÊ±ÇÂá∫ÂèëÁúãÁúã‰∏∫‰ªÄ‰πàËøô‰∏™Á≥ªÁªüÈúÄË¶ÅËÆæËÆ°ÊàêËøô‰∏™Ê†∑Â≠êÔºåËøô‰∏™Ê®°Âùó‰ª•ÂèäÂú®Ê∫êÁ†ÅÂ±ÇÈù¢ÊòØ‰ΩïÂ¶ÇÂÆûÁé∞ÁöÑÔºåËøôÊ†∑ÁöÑÂÆûÁé∞Êúâ‰ªÄ‰πà‰∫ÆÁÇπ‰ª•ÂèäÂ∑•Á®ãËÄÉÈáèÔºå‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Êàë‰ª¨Ëøò‰ºöÁùÄÈáçÂÖ≥Ê≥®ÂÖ∂‰∏≠‰∏éÂÆâÂÖ®Áõ∏ÂÖ≥ÁöÑÁªÜËäÇÔºåÂÖ≥Ê≥®Á≥ªÁªüÁöÑÂÖ®Ë≤åÔºåÈáçÁé∞ÊÄùËÄÉÂÆâÂÖ®Á≥ªÁªüÁöÑÊûÑÂª∫„ÄÇ üå† ÊàëÊòØË∞ÅÔºüÊàëËÉΩÂÅö‰ªÄ‰πàÔºü‚Äî‚Äî ËÆ§ËØÅ‰∏éÊéàÊùÉ ËÆ§ËØÅÂíåÊéàÊùÉÊòØ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" /><meta property="og:image" content="https://p1nant0m.com/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-30T12:00:00+00:00" />
<meta property="article:modified_time" content="2023-08-30T12:00:00+00:00" /><meta property="og:site_name" content="p1nant0m" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://p1nant0m.com/logo.png"/>

<meta name="twitter:title" content="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds"/>
<meta name="twitter:description" content="ÊúÄËøëÂú®Â≠¶‰π†‰∫ëÂéüÁîüÊúÄ‰Ω≥ÂÆâÂÖ®ÂÆûË∑µÔºåÂÖ∂‰∏≠ÊèêÂà∞‰∫Ü k8s ‰∏≠ÁöÑËÆ§ËØÅ‰∏éÊéàÊùÉÊ®°ÂùóÔºå‰∏∫‰∫ÜÂä†Ê∑±ÁêÜËß£‰ª•ÂèäÊúâÂØπ k8s Ê∫êÁ†ÅÈòÖËØªÁöÑËÆ°ÂàíÔºå‰æøËØûÁîü‰∫ÜËøô‰∏™[‚ú®Êé¢Á¥¢Á≥ªÂàó]„ÄÇÊàë‰ª¨Â∞Ü‰ªéÈúÄÊ±ÇÂá∫ÂèëÁúãÁúã‰∏∫‰ªÄ‰πàËøô‰∏™Á≥ªÁªüÈúÄË¶ÅËÆæËÆ°ÊàêËøô‰∏™Ê†∑Â≠êÔºåËøô‰∏™Ê®°Âùó‰ª•ÂèäÂú®Ê∫êÁ†ÅÂ±ÇÈù¢ÊòØ‰ΩïÂ¶ÇÂÆûÁé∞ÁöÑÔºåËøôÊ†∑ÁöÑÂÆûÁé∞Êúâ‰ªÄ‰πà‰∫ÆÁÇπ‰ª•ÂèäÂ∑•Á®ãËÄÉÈáèÔºå‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Êàë‰ª¨Ëøò‰ºöÁùÄÈáçÂÖ≥Ê≥®ÂÖ∂‰∏≠‰∏éÂÆâÂÖ®Áõ∏ÂÖ≥ÁöÑÁªÜËäÇÔºåÂÖ≥Ê≥®Á≥ªÁªüÁöÑÂÖ®Ë≤åÔºåÈáçÁé∞ÊÄùËÄÉÂÆâÂÖ®Á≥ªÁªüÁöÑÊûÑÂª∫„ÄÇ üå† ÊàëÊòØË∞ÅÔºüÊàëËÉΩÂÅö‰ªÄ‰πàÔºü‚Äî‚Äî ËÆ§ËØÅ‰∏éÊéàÊùÉ ËÆ§ËØÅÂíåÊéàÊùÉÊòØ"/>
<meta name="application-name" content="ÊàëÁöÑÁΩëÁ´ô">
<meta name="apple-mobile-web-app-title" content="ÊàëÁöÑÁΩëÁ´ô"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" /><link rel="prev" href="https://p1nant0m.com/2023-07-16-hackthebox-busqueda/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "[‚ú®Exploration Series] Kubernetes Authentications \u0026 Authorization Mechanismds",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/p1nant0m.com\/exploration-series-kubernetes-authenticationsa\/"
        },"genre": "posts","keywords": "Kubernetes, Auth \u0026 Authz","wordcount":  3690 ,
        "url": "https:\/\/p1nant0m.com\/exploration-series-kubernetes-authenticationsa\/","datePublished": "2023-08-30T12:00:00+00:00","dateModified": "2023-08-30T12:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "p1nant0m"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84EW6PHH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CX84EW6PHH');
    </script>
    
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="p1nant0m"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> ÊñáÁ´† </a><a class="menu-item" href="/tags/"> Ê†áÁ≠æ </a><a class="menu-item" href="/categories/"> ÂàÜÁ±ª </a><a class="menu-item" href="/about/"> ÂÖ≥‰∫é </a><a class="menu-item" href="/friends/"> ÂèãÈìæ </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="ÊêúÁ¥¢ÊñáÁ´†Ê†áÈ¢òÊàñÂÜÖÂÆπ..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="ÊêúÁ¥¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Ê∏ÖÁ©∫">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="ÂàáÊç¢‰∏ªÈ¢ò">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="ÈÄâÊã©ËØ≠Ë®Ä">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/exploration-series-kubernetes-authenticationsa/" selected>ÁÆÄ‰Ωì‰∏≠Êñá</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84EW6PHH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CX84EW6PHH');
    </script>

    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="p1nant0m"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="ÊêúÁ¥¢ÊñáÁ´†Ê†áÈ¢òÊàñÂÜÖÂÆπ..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="ÊêúÁ¥¢">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Ê∏ÖÁ©∫">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        ÂèñÊ∂à
                    </a>
                </div><a class="menu-item" href="/posts/" title="">ÊñáÁ´†</a><a class="menu-item" href="/tags/" title="">Ê†áÁ≠æ</a><a class="menu-item" href="/categories/" title="">ÂàÜÁ±ª</a><a class="menu-item" href="/about/" title="">ÂÖ≥‰∫é</a><a class="menu-item" href="/friends/" title="">ÂèãÈìæ</a><a href="javascript:void(0);" class="menu-item theme-switch" title="ÂàáÊç¢‰∏ªÈ¢ò">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="ÈÄâÊã©ËØ≠Ë®Ä">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/exploration-series-kubernetes-authenticationsa/" selected>ÁÆÄ‰Ωì‰∏≠Êñá</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ÁõÆÂΩï</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[‚ú®Exploration Series] Kubernetes Authentications & Authorization Mechanismds</h1><h2 class="single-subtitle">[‚ú®Êé¢Á¥¢Á≥ªÂàó] kubernetes ‰∏≠ÁöÑËÆ§ËØÅ‰∏éÊéàÊùÉÊú∫Âà∂</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>p1nant0m</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-08-30">2023-08-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;Á∫¶ 3690 Â≠ó&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;È¢ÑËÆ°ÈòÖËØª 8 ÂàÜÈíü&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>ÁõÆÂΩï</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#-ÊàëÊòØË∞ÅÊàëËÉΩÂÅö‰ªÄ‰πà-ËÆ§ËØÅ‰∏éÊéàÊùÉ">üå† ÊàëÊòØË∞ÅÔºüÊàëËÉΩÂÅö‰ªÄ‰πàÔºü‚Äî‚Äî ËÆ§ËØÅ‰∏éÊéàÊùÉ</a></li>
            <li><a href="#-overviews-in-kubernetes-authenticating-model">üåÑ Overviews In Kubernetes Authenticating Model</a></li>
            <li><a href="#-security-issues-related-to-super-privilege-serviceaccount">üå† Security Issues Related to Super-Privilege Serviceaccount</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>ÊúÄËøëÂú®Â≠¶‰π†<strong>‰∫ëÂéüÁîüÊúÄ‰Ω≥ÂÆâÂÖ®ÂÆûË∑µ</strong>ÔºåÂÖ∂‰∏≠ÊèêÂà∞‰∫Ü k8s ‰∏≠ÁöÑËÆ§ËØÅ‰∏éÊéàÊùÉÊ®°ÂùóÔºå‰∏∫‰∫ÜÂä†Ê∑±ÁêÜËß£‰ª•ÂèäÊúâÂØπ k8s Ê∫êÁ†ÅÈòÖËØªÁöÑËÆ°ÂàíÔºå‰æøËØûÁîü‰∫ÜËøô‰∏™[‚ú®Êé¢Á¥¢Á≥ªÂàó]„ÄÇÊàë‰ª¨Â∞Ü‰ªéÈúÄÊ±ÇÂá∫ÂèëÁúãÁúã‰∏∫‰ªÄ‰πàËøô‰∏™Á≥ªÁªüÈúÄË¶ÅËÆæËÆ°ÊàêËøô‰∏™Ê†∑Â≠êÔºåËøô‰∏™Ê®°Âùó‰ª•ÂèäÂú®Ê∫êÁ†ÅÂ±ÇÈù¢ÊòØ‰ΩïÂ¶ÇÂÆûÁé∞ÁöÑÔºåËøôÊ†∑ÁöÑÂÆûÁé∞Êúâ‰ªÄ‰πà‰∫ÆÁÇπ‰ª•ÂèäÂ∑•Á®ãËÄÉÈáèÔºå‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Êàë‰ª¨Ëøò‰ºöÁùÄÈáçÂÖ≥Ê≥®ÂÖ∂‰∏≠‰∏éÂÆâÂÖ®Áõ∏ÂÖ≥ÁöÑÁªÜËäÇÔºåÂÖ≥Ê≥®Á≥ªÁªüÁöÑÂÖ®Ë≤åÔºåÈáçÁé∞ÊÄùËÄÉÂÆâÂÖ®Á≥ªÁªüÁöÑÊûÑÂª∫„ÄÇ</p>
<h4 id="-ÊàëÊòØË∞ÅÊàëËÉΩÂÅö‰ªÄ‰πà-ËÆ§ËØÅ‰∏éÊéàÊùÉ">üå† ÊàëÊòØË∞ÅÔºüÊàëËÉΩÂÅö‰ªÄ‰πàÔºü‚Äî‚Äî ËÆ§ËØÅ‰∏éÊéàÊùÉ</h4>
<p>ËÆ§ËØÅÂíåÊéàÊùÉÊòØËÆ°ÁÆóÊú∫ÁΩëÁªúÂÆâÂÖ®‰∏≠ÁöÑ‰∏§‰∏™ËÄÅÁîüÂ∏∏Ë∞àÁöÑÂü∫Êú¨ÈóÆÈ¢òÔºåÂÆÉ‰ª¨ÈÉΩÊó®Âú®Á°Æ‰øùÂè™ÊúâÊéàÊùÉÁî®Êà∑ÊâçËÉΩËÆøÈóÆÂèó‰øùÊä§ÁöÑËµÑÊ∫ê„ÄÇ‰∏∫‰∫ÜÂÆûÁé∞ËÆ§ËØÅ‰∏éÊéàÊùÉÊú∫Âà∂ÔºåÊàë‰ª¨ÈúÄË¶ÅËß£ÂÜ≥ÊäõÂá∫‰∏§‰∏™ÈóÆÈ¢òËÆ©Â§ßÂÆ∂Êù•ÊÄùËÄÉ‰∏Ä‰∏ãÔºö1ÔºâÂ¶Ç‰ΩïËØÅÊòé‰Ω†Ôºà‰∏ª‰ΩìÔºâÁöÑË∫´‰ªΩÔºå2ÔºâÂ¶Ç‰ΩïÁ°Æ‰øù‰Ω†Ôºà‰∏ª‰ΩìÔºâÊ≠£Âú®ËÆøÈóÆÔºàË°å‰∏∫ÔºâÁöÑËµÑÊ∫êÔºàÂÆ¢‰ΩìÔºâÊòØ<strong>ÂêàÊ≥ï</strong>ÁöÑÔºü</p>
<p>ÂØπ‰∫éÈóÆÈ¢òÔºà1ÔºâÂ¶Ç‰ΩïËØÅÊòé‰Ω†Ôºà‰∏ª‰ΩìÔºâÁöÑË∫´‰ªΩÔºåÁªèÂÖ∏ÁöÑËß£ÂÜ≥ÊÄùË∑ØÊúâÔºöa) Êèê‰æõÂè™Êúâ‰Ω†Áü•ÈÅìÁöÑÁßòÂØÜÔºàÂè£‰ª§ÔºâÔºåb) ËÆ©‰∏Ä‰∏™Identity ProviderÁ¨¨‰∏âÊñπÂçèÂä©‰Ω†ËØÅÊòé‰Ω†ÁöÑË∫´‰ªΩÔºàOAuthÔºâÔºåÂØπ‰∫éÈóÆÈ¢òÔºà2ÔºâÂ¶Ç‰ΩïÁ°Æ‰øù‰Ω†Ê≠£Âú®ËÆøÈóÆÁöÑËµÑÊ∫êÊòØÂêàÊ≥ïÁöÑÔºåËß£ÂÜ≥ÊÄùË∑ØÊòØÂª∫Á´ãËÆøÈóÆÊéßÂà∂Ê®°ÂûãÔºåÂÖ∏ÂûãÁöÑËÆøÈóÆÊéßÂà∂Ê®°ÂûãÊúâÔºåACL(Access-Control-List), RBAC(Role-Based-Access-Control), ABAC(Attribute-Based-Access-Control)‰ª•ÂèäNGAC(Next-Generation-Access-Control)„ÄÇ</p>
<p>ÂØπ‰∫éËÆ§ËØÅËÄåË®ÄÔºå‰∏∫‰∫ÜËææÊàê‰∏Ä‰∏™‰ºòËâØÁöÑÁî®Êà∑‰ΩìÈ™åÔºà‰∏çÈúÄË¶ÅÁî®Êà∑Âú®ËøõË°åÊìç‰ΩúÊó∂ÂèçÂ§çËøõË°åËÆ§ËØÅÔºâÔºåÂú®ÂÆûË∑µ‰∏≠ÂæÄÂæÄÈúÄË¶ÅÂÆûÁé∞‰∏Ä‰∏™ÂèØ‰ª•Âú®‰∏Ä‰∏™Êó∂Èó¥Âë®ÊúüÂÜÖÂêëÊúçÂä°Âô®ËØÅÊòéËá™Ë∫´Âπ∂Áª¥ÊåÅÂèØ‰ø°Áä∂ÊÄÅÁöÑÊú∫Âà∂ÔºåËøôÁßçÊú∫Âà∂ÈúÄË¶ÅÊï∞ÊçÆ‰ø°ÊÅØÁöÑÊîØÊíëÔºåÊ†πÊçÆÊï∞ÊçÆ‰ø°ÊÅØÂ≠òÂÇ®‰ΩçÁΩÆÁöÑ‰∏çÂêåÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÂàÜ‰∏∫ÊúçÂä°Âô®‰æßÁª¥Êä§‰ª•ÂèäÁî®Êà∑‰æßÁª¥Êä§„ÄÇ</p>
<p>Áî®Êà∑‰æßÂ≠òÂÇ®Âá≠ËØÅÁª¥ÊåÅÊú∫Âà∂ÔºöBasic TokenÔºàBase64ÁºñÁ†Åusername:passwordÔºåÂú®ÊúçÂä°Âô®‰æßÊ†°È™åÂá≠ËØÅÁöÑÂêàÊ≥ïÊÄßÔºâÔºåBearer Token(Êê∫Â∏¶Áî®Êà∑Âá≠ËØÅ‰Ωú‰∏∫Êï∞ÊçÆËΩΩËç∑ÔºåÈÄöËøáÁ≠æÂêçÁÆóÊ≥ïÂÆûÁé∞Èò≤ÁØ°ÊîπÔºâÔºåClient CertificateÔºàÂÆ¢Êà∑‰æßËØÅ‰π¶ÔºåÁî±ÂèØ‰ø°ÁõÆÊ†áCAÁ≠æÂèëÔºå‰∏ª‰ΩìÊã•ÊúâÁßÅÈí•ËØÅÊòéËá™Ë∫´ÁöÑÂêàÊ≥ïÊÄßÔºâ„ÄÇ</p>
<p>Ëß£ÊûêÂêéÁöÑJWTÁ§∫‰æãÔºàBearer TokenÔºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="err">HEADER:ALGORITHM</span> <span class="err">&amp;</span> <span class="err">TOKEN</span> <span class="err">TYPE</span>
<span class="p">{</span>
  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;RS256&#34;</span><span class="p">,</span>
  <span class="nt">&#34;kid&#34;</span><span class="p">:</span> <span class="s2">&#34;VsVyOVilN85xFdtqJZMMTlkqpQA_WZgLAfg51igPox8&#34;</span>
<span class="p">}</span>

<span class="err">PAYLOAD:DATA</span>
<span class="p">{</span>
  <span class="nt">&#34;aud&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&#34;https://kubernetes.default.svc.cluster.local&#34;</span>
  <span class="p">],</span>
  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1667530848</span><span class="p">,</span>
  <span class="nt">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1667527248</span><span class="p">,</span>
  <span class="nt">&#34;iss&#34;</span><span class="p">:</span> <span class="s2">&#34;https://kubernetes.default.svc.cluster.local&#34;</span><span class="p">,</span>
  <span class="nt">&#34;kubernetes.io&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;namespace&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
    <span class="nt">&#34;serviceaccount&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;cilium&#34;</span><span class="p">,</span>
      <span class="nt">&#34;uid&#34;</span><span class="p">:</span> <span class="s2">&#34;302b0155-6608-4b70-be4b-f7fb2bb73beb&#34;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&#34;nbf&#34;</span><span class="p">:</span> <span class="mi">1667527248</span><span class="p">,</span>
  <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;system:serviceaccount:default:cilium&#34;</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Ëß£ÊûêÂêéÁöÑX509 Client CertificateÁ§∫‰æãÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Version:          3 (0x02)
Serial number:    1041774366814885730 (0x0e7520445e1bd762)
Algorithm ID:     SHA256withRSA
Validity
  Not Before:     22/08/2023 03:12:59 (dd-mm-yyyy hh:mm:ss) (230822031259Z)
  Not After:      21/08/2024 03:18:00 (dd-mm-yyyy hh:mm:ss) (240821031800Z)
Issuer
  CN = kubernetes
Subject
  O  = system:masters
  CN = kubernetes-admin
Public Key
  Algorithm:      RSA
  Length:         2048 bits
  Modulus:        bf:a4:cf:72:34:07:a7:0c:4b:db:19:2a:f7:60:10:68:
                  8b:52:db:e9:3f:24:d5:05:c5:4b:c7:f5:04:1e:01:d4:
                  2a:e5:a5:59:4e:66:6f:25:eb:9f:1b:a5:91:81:28:18:
                  7f:a3:fd:36:c5:45:e5:ea:ef:18:a0:f8:61:1a:bc:6b:
                  ee:d5:18:5e:3a:08:c0:11:d4:62:3c:40:18:6f:e6:56:
                  49:fe:01:5b:c5:56:f2:ab:4e:db:9f:96:4e:2f:e3:26:
                  56:39:4b:e8:08:7d:e3:9c:15:01:be:86:8b:ce:b4:8e:
                  7e:b7:1f:f9:98:4d:fc:13:7a:0a:f5:d1:bf:11:c7:4d:
                  11:41:d5:14:92:4a:3e:ef:c9:03:07:58:5a:49:31:df:
                  c6:21:64:b6:5e:2e:1a:f8:da:4e:1a:7e:1b:7b:48:10:
                  9c:93:05:bd:a1:9e:f8:2c:75:0a:1a:4b:c6:1c:11:95:
                  de:9a:7f:dd:12:9e:94:7a:68:07:4d:19:ed:fb:63:26:
                  aa:a4:0a:71:81:83:a0:ad:94:e8:1e:7b:cc:dc:39:3c:
                  ca:ae:bf:ba:50:57:37:87:a4:e9:b7:b1:1c:27:0a:18:
                  18:51:5c:55:28:87:0a:18:12:35:99:14:c4:10:53:37:
                  26:2d:fa:69:7e:b2:d8:8d:f1:dc:76:83:01:a7:81:e5
  Exponent:       65537 (0x10001)
Certificate Signature
  Algorithm:      SHA256withRSA
  Signature:      92:d7:99:22:91:2f:f3:ef:38:25:b4:ad:ea:7d:2c:b7:
                  a1:bb:cf:a4:eb:a0:f8:86:b9:ea:2b:e8:39:0e:0d:3c:
                  27:72:19:33:a1:69:e6:72:6b:f0:82:9e:f1:44:e6:0a:
                  1d:9b:55:58:e6:79:75:84:af:65:d2:5c:30:8d:1f:0e:
                  25:18:62:5a:9f:7e:0a:20:79:da:29:be:bc:16:3d:d2:
                  4e:fa:0f:13:c2:9a:5a:bb:98:32:55:ae:a3:bf:36:db:
                  00:fc:db:6a:ef:7e:09:f2:8a:aa:22:ca:90:db:b8:15:
                  70:5d:b2:1b:b6:b9:37:93:52:8c:d9:92:0f:38:97:bb:
                  93:c7:90:19:e7:c1:41:29:2f:7f:b8:02:03:07:43:47:
                  0a:6d:bb:f5:1f:e5:42:e2:22:19:6e:dc:e1:8e:fb:49:
                  c2:43:69:1a:85:1e:9e:99:9e:e3:85:83:91:15:e3:9c:
                  b8:17:7d:83:65:db:c8:03:ee:4a:1e:75:98:66:2f:e7:
                  86:40:ea:71:17:b8:34:bc:a4:b9:48:4b:1f:a3:42:c1:
                  a2:e7:70:b7:0d:25:7d:af:16:40:63:49:fd:d1:85:67:
                  1f:2b:5a:4e:25:cc:b9:a6:99:4b:5c:03:c0:ad:3c:e8:
                  97:d1:6b:29:74:5e:5b:a0:99:f1:09:69:f9:d8:59:aa

Extensions
  keyUsage CRITICAL:
    digitalSignature,keyEncipherment
  extKeyUsage :
    clientAuth
  basicConstraints CRITICAL:
    {}
  authorityKeyIdentifier :
    kid=d2003d36621e663f31e8b164d33f6dbf9433c371
</code></pre></td></tr></table>
</div>
</div><p>ÊúçÂä°Âô®‰æßÂ≠òÂÇ®Âá≠ËØÅÁª¥ÊåÅÊú∫Âà∂ÔºöSessionIDÔºà‰∏çÊê∫Â∏¶Áî®Êà∑Âá≠ËØÅÔºåÊØè‰∏Ä‰∏™IDÁªëÂÆö‰∏Ä‰∏™Áî®Êà∑Âá≠ËØÅÂπ∂Áî±ÊúçÂä°Âô®Âú®ÂêéÂè∞ËøõË°åÁÆ°ÁêÜÔºâ„ÄÇ</p>
<p>‰∏§ËÄÖÂÆûÁé∞ÊñπÊ≥ïÂêÑÊúâÂçÉÁßãÔºåÊØîÂ¶ÇÔºå‰ΩøÁî®Session IDÈúÄË¶ÅÂú®ÊúçÂä°Âô®Á´ØÁª¥Êä§‰ºöËØùÁä∂ÊÄÅÔºåËÄåBearer TokenÂèØ‰ª•Áõ¥Êé•Â∞Ü‰∏éÁî®Êà∑Âá≠ËØÅÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÂ≠òÂÇ®Âú®ÂÆ¢Êà∑Á´Ø‰∏äÔºå‰∏çÈúÄË¶ÅÊúçÂä°Âô®Á´ØËøõË°å‰ºöËØùÁÆ°ÁêÜÔºåÂè™ÈúÄË¶ÅÂú®ËøõË°åÁõ∏ÂÖ≥Êìç‰ΩúÊó∂ÂØπTokenËøõË°åÁ≠æÂêçÁöÑÊ†°È™åÔºåÁ°ÆËÆ§ÂÖ∂ÂêàÊ≥ïÊÄßÂç≥ÂèØ„ÄÇ</p>
<p>Âú®Êú¨ËäÇÂàùÊàë‰ª¨ÊèêÂà∞‰∫Ü<strong>ÂêàÊ≥ï</strong>Ëøô‰∏™ËØçÔºåËøô‰∏™ËØçÂ∏¶Êúâ‰∏ÄÁÇπÂÑøÊùÉÂ®ÅÁ¨¨‰∏âÊñπ‰∏ãÂÆö‰πâÁöÑÂÆö‰πâÁöÑÊÑèÂë≥ÔºåÊàë‰ª¨Âßë‰∏îÊääËøô‰∏™ÊùÉÂ®ÅÁ¨¨‰∏âÊñπÁß∞‰ΩúÁÆ°ÁêÜËÄÖ„ÄÇ<strong>ÊéàÊùÉ‰æøÊòØÁî±ÁÆ°ÁêÜËÄÖÂÜ≥ÂÆö‰∏ª‰ΩìÁöÑÂì™‰∫õË°å‰∏∫ÊòØÂêàÊ≥ïÁöÑËøáÁ®ã</strong>„ÄÇ</p>
<p>ÁÆ°ÁêÜËÄÖÊèê‰æõÂØπ‰∏ª‰ΩìÔºàÁî®Êà∑ÔºâËøõË°åË∫´‰ªΩËÆ§ËØÅÁöÑÊú∫Âà∂Âπ∂‰∏∫ÂÖ∂ÊâÄÁÆ°ÁêÜÁöÑÂÆ¢‰ΩìÔºàËµÑÊ∫êÔºâÂà∂ÂÆöËÆøÈóÆËßÑÂàôÔºåÁ°Æ‰øùÂè™ÊúâÊª°Ë∂≥ËßÑÂàô‰πã‰∏ãÁöÑ‰∏ª‰ΩìÊâçËÉΩÂ§üÂØπËøô‰∫õÂÆ¢‰ΩìÔºàËµÑÊ∫êÔºâËøõË°åÁõ∏ÂÖ≥ÁöÑË°å‰∏∫Êìç‰Ωú„ÄÇËøôÊ†∑ÁöÑËßÑÂàô‰∏ÄËà¨Áî±‰∏Ä‰∏™‰∏âÂÖÉÁªÑÁªÑÊàêÔºåÂÆÉ‰ª¨ÂàÜÂà´ÊòØ‰∏ª‰Ωì„ÄÅÂÆ¢‰Ωì‰ª•ÂèäË°å‰∏∫Ôºå‰∏ãÈù¢Â±ïÁ§∫‰∫Ü‰∏Ä‰∫õÊ†πÊçÆ‰∏çÂêåACÊ®°ÂûãÂà∂ÂÆöÁöÑËßÑÂàô„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">|      Subject      |       Object                      |         Action
        Alice              /api/v1/*                                GET
        Admin                 *                                      *
        Guest            /api/v1/hello                              GET    
        
     [Bod, Danny]    [/api/v1/stock/*, /api/v1/db/*]           GET, POST, DELETE
        Watcher           [/api/v1/stock/*]                         GET
        Dannis              Watcher
        
      tag:age:&gt;22         /api/v1/secrets/*                         GET              
</code></pre></td></tr></table>
</div>
</div><p>Ê≠£Á°ÆÊñΩË°åÁöÑÊéàÊùÉÊú∫Âà∂‰øùÈöú‰∫ÜÔºö1Ôºâ‰∏™‰∫∫Êï∞ÊçÆÂíåÈöêÁßÅ‰∏çË¢´Êª•Áî®ÊàñÊ≥ÑÈú≤Ôºå2ÔºâÁ°Æ‰øùÁ≥ªÁªüÂíåÊï∞ÊçÆÁöÑÂÆâÂÖ®Ôºå‰ª•Èò≤Ê≠¢Êú™ÁªèÊéàÊùÉÁöÑËÆøÈóÆÊàñÊîªÂáªÔºå3ÔºâÁ°Æ‰øùÊØè‰∏™Áî®Êà∑ÊàñÂ∫îÁî®Á®ãÂ∫èÂè™ËÉΩËÆøÈóÆÂÖ∂ÊâÄÈúÄÁöÑËµÑÊ∫êÊàñÊï∞ÊçÆÔºåËÄå‰∏çÊòØË∂ÖÂá∫ÂÖ∂ÊùÉÈôêÁöÑÂÜÖÂÆπÔºå4ÔºâÁ°Æ‰øùÊéàÊùÉ‰∫∫Ëé∑ÂæóÈÄÇÂΩìÁöÑËÆ∏ÂèØËØÅÊàñÊùÉÈôêÔºå‰ª•‰ΩøÁî®ÂèóÈôêÂà∂ÁöÑËµÑÊ∫êÊàñÊï∞ÊçÆ„ÄÇ</p>
<p>k8s‰∏≠ÁöÑËÆ§ËØÅ‰∏éÈâ¥ÊùÉÊú∫Âà∂‰πü‰∏áÂèò‰∏çÁ¶ªÂÖ∂ÂÆóÔºåÊàë‰ª¨Âú®‰∏ã‰∏ÄÁ´†ËäÇ‰∏≠Â∞ÜÁúãÂà∞k8s‰∏äÁöÑËÆ§ËØÅ‰∏éÈâ¥ÊùÉ„ÄÇ</p>
<h4 id="-overviews-in-kubernetes-authenticating-model">üåÑ Overviews In Kubernetes Authenticating Model</h4>
<p>ÂÆûÈ™åÁéØÂ¢ÉÔºö</p>
<p>Kind Êê≠Âª∫ k8s ÈõÜÁæ§ÔºåHTTPie ‰Ωú‰∏∫ HTTP ClientÔºåk9s ÂèØËßÜÂåñÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÁÆ°ÁêÜ k8s ÈõÜÁæ§„ÄÇ‰∏ãÈù¢ÁªôÂá∫ÁöÑÊòØÊú¨ÂÆûÈ™åÊâÄ‰ΩøÁî®Âà∞ÁöÑ config.yamlÔºåÁî®‰∫éÈÖçÁΩÆ kind ÂàõÂª∫ k8s ÈõÜÁæ§„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="c"># config.yaml</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">kind.x-k8s.io/v1alpha4</span><span class="w">
</span><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">k8s-exp</span><span class="w">
</span><span class="w"></span><span class="nt">nodes</span><span class="p">:</span><span class="w">
</span><span class="w"></span>- <span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l">control-plane</span><span class="w">
</span><span class="w"></span>- <span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l">worker</span><span class="w">
</span><span class="w"></span>- <span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l">worker</span><span class="w">
</span><span class="w"></span>- <span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l">worker</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>k8s ‰∏≠ÁöÑËÆ§ËØÅÁ≠ñÁï• Ôºà<a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/" target="_blank" rel="noopener noreffer ">Authentication Strategies</a>Ôºâ</p>
<ul>
<li><strong>X509 Client Certs</strong></li>
<li>Static Token File</li>
<li>Bootstrap Tokens</li>
<li><strong>Service Account Tokens</strong></li>
<li>OpenID Connect Tokens</li>
<li>Webhook Token Authentication</li>
<li>Authenticating Proxy</li>
</ul>
<blockquote>
<p>It is assumed that a cluster-independent service manages normal users in the following ways:</p>
<ul>
<li>an administrator distributing private keys</li>
<li>a user store like Keystone or Google Accounts</li>
<li>a file with a list of usernames and passwords</li>
</ul>
<p>**In this regard, **<em><strong>Kubernetes does not have objects which represent normal user accounts.</strong></em></p>
</blockquote>
<ul>
<li>‰ΩøÁî® <strong>kubelet</strong>(credential in <code>.kube</code> directory) ÁöÑË∫´‰ªΩ‰∏é <strong>apiserver</strong> ËøõË°åÈÄö‰ø° ÔºàClient Certs | mTLSÔºâ</li>
<li>‰ΩøÁî® system:serviceaccount:default:cilium Ë∫´‰ªΩ‰∏é <strong>apiserver</strong> ËøõË°åÈÄö‰ø° ÔºàBearer TokenÔºâ</li>
</ul>
<ol>
<li>Create ClusterRole [Cross Namespaces]</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRole</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="c"># &#34;namespace&#34; omitted since ClusterRoles are not namespaced</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-reader</span><span class="w">
</span><span class="w"></span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span><span class="w"></span>- <span class="nt">apiGroups</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;&#34;</span><span class="p">]</span><span class="w">
</span><span class="w">  </span><span class="c">#</span><span class="w">
</span><span class="w">  </span><span class="c"># at the HTTP level, the name of the resource for accessing Secret</span><span class="w">
</span><span class="w">  </span><span class="c"># objects is &#34;secrets&#34;</span><span class="w">
</span><span class="w">  </span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;secrets&#34;</span><span class="p">]</span><span class="w">
</span><span class="w">  </span><span class="nt">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;watch&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;list&#34;</span><span class="p">]</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Create ServiceAccount</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">kubectl create serviceaccount cilium
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>Create ClusterRoleBinding</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io/v1</span><span class="w">
</span><span class="w"></span><span class="c"># This role binding allows &#34;dave&#34; to read secrets in the &#34;development&#34; namespace.</span><span class="w">
</span><span class="w"></span><span class="c"># You need to already have a ClusterRole named &#34;secret-reader&#34;.</span><span class="w">
</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRoleBinding</span><span class="w">
</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">read-secrets-global</span><span class="w">
</span><span class="w"></span><span class="nt">subjects</span><span class="p">:</span><span class="w">
</span><span class="w"></span>- <span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ServiceAccount</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">cilium</span><span class="w"> </span><span class="c"># Name is case sensitive</span><span class="w">
</span><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;default&#34;</span><span class="w">
</span><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span><span class="w"></span><span class="nt">roleRef</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ClusterRole</span><span class="w">
</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">secret-reader</span><span class="w">
</span><span class="w">  </span><span class="nt">apiGroup</span><span class="p">:</span><span class="w"> </span><span class="l">rbac.authorization.k8s.io</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>Create token for <em>system:serviceaccount:default:cilium</em></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">kubectl create token cilium
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ServiceAccounts Using certificate to communicate with apiserver? Basic Steps (Guessing):</p>
<p>  1.Create Private Key and generate certificate.</p>
<p>  2.Create X509 certificates for client [/CN=&lsquo;system:serviceaccount:default:cilium&rsquo;]</p>
<p>  3.Generate csr and request CA to sign the certificate</p>
<p>  4.Building mTLS communication to the apiserver with the certificate </p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="http://image.p1nant0m.com/202309202126336.png"
        data-srcset="http://image.p1nant0m.com/202309202126336.png, http://image.p1nant0m.com/202309202126336.png 1.5x, http://image.p1nant0m.com/202309202126336.png 2x"
        data-sizes="auto"
        alt="http://image.p1nant0m.com/202309202126336.png"
        title="http://image.p1nant0m.com/202309202126336.png" /></p>
<p>ÈÄöËøá‰∏äËø∞Êìç‰ΩúÔºå‰Ωç‰∫é [default] ÂëΩÂêçÁ©∫Èó¥‰∏ãÁöÑ [cilium] <strong>ServiceAccount</strong> ‰æøÂèØ‰ª•ÂØπÈõÜÁæ§ÁéØÂ¢É‰∏≠ÁöÑÊâÄÊúâ <strong>Secrets</strong> ËøõË°å get„ÄÅwatch„ÄÅlist Êìç‰Ωú‰∫Ü„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># request</span>
<span class="nv">$http</span> -A bearer -a eyJhbGciOiJSUzI1NiIsImtpZCI6IlZzVnlPVmlsTjg1eEZkdHFKWk1NVGxrcXBRQV9XWmdMQWZnNTFpZ1BveDgifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNjY3NTMwODQ4LCJpYXQiOjE2Njc1MjcyNDgsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImNpbGl1bSIsInVpZCI6IjMwMmIwMTU1LTY2MDgtNGI3MC1iZTRiLWY3ZmIyYmI3M2JlYiJ9fSwibmJmIjoxNjY3NTI3MjQ4LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpjaWxpdW0ifQ.T8Hekf2GGRBfBpKeKZsgyTYJvCEsRbG-cIydmi9lQR7YEzT-_2zhyIto8cDphnbhGSAnyjz8Ia2LruW2FAHawKMZdkTUbigCsnE0adUcri1-lHbV4SYI-PSXGvktnDsEpaauqDVa3AmlTn_o35UnqQDMNed5-5DIFWm3AcqWwZthriSuEH9j8HiaMRtV8-4YuwcVZyQ6bANUGkOsYd_IOHnt1ZT9fJ2mJnWvOjjO7xjcUjcD38DtClwRdTD7pY_BDONw1TashsjXcYNIeXk7n5fBHkENgUktS_3HyRP-whkX2Td-SghZTTYYd7cLhMVYKZL1-kBdi0Q9R4LhEjalvA https://127.0.0.1:44257/api/v1/namespaces/default/pods<span class="se">\?</span>limit<span class="se">\=</span><span class="m">500</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># response</span>
<span class="o">{</span>
    <span class="s2">&#34;apiVersion&#34;</span>: <span class="s2">&#34;v1&#34;</span>,
    <span class="s2">&#34;items&#34;</span>: <span class="o">[]</span>,
    <span class="s2">&#34;kind&#34;</span>: <span class="s2">&#34;SecretList&#34;</span>,
    <span class="s2">&#34;metadata&#34;</span>: <span class="o">{</span>
        <span class="s2">&#34;resourceVersion&#34;</span>: <span class="s2">&#34;72253&#34;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Êàë‰ª¨‰ΩøÁî® <code>kubectl</code> ÂëΩ‰ª§Êù•ËßÇÂØüÂêë <strong>apiserver</strong> ËØ∑Ê±ÇÂàõÂª∫‰∏Ä‰∏™ <strong>secret</strong> Êó∂ÔºåÊâÄÊûÑÈÄ†ÁöÑ HTTP Êä•ÊñáÊ†ºÂºèÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">kubectl create secret generic top-secret --from-file<span class="o">=</span>topsecret.txt --namespace<span class="o">=</span>default -v<span class="o">=</span><span class="m">8</span>

<span class="o">{</span><span class="s2">&#34;kind&#34;</span>:<span class="s2">&#34;Secret&#34;</span>,<span class="s2">&#34;apiVersion&#34;</span>:<span class="s2">&#34;v1&#34;</span>,<span class="s2">&#34;metadata&#34;</span>:<span class="o">{</span><span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;top-secret&#34;</span>,<span class="s2">&#34;namespace&#34;</span>:<span class="s2">&#34;default&#34;</span>,<span class="s2">&#34;creationTimestamp&#34;</span>:null<span class="o">}</span>,<span class="s2">&#34;data&#34;</span>:<span class="o">{</span><span class="s2">&#34;topsecret.txt&#34;</span>:<span class="s2">&#34;W1RPUCBTRUNSRVRdCg==&#34;</span><span class="o">}}</span>

POST https://127.0.0.1:44257/api/v1/namespaces/default/secrets
</code></pre></td></tr></table>
</div>
</div><p>Áõ∏ÂÖ≥ÁöÑ RESTful API <a href="https://kubernetes.io/docs/reference/kubernetes-api/config-and-storage-resources/secret-v1/#create-create-a-secret" target="_blank" rel="noopener noreffer ">ÁªÜËäÇÂèØ‰ª•Êü•Áúã</a>Ôºö</p>
<p>Êàë‰ª¨‰ΩøÁî® <em>system:serviceaccount:default:cilium</em> Ë∫´‰ªΩÂêë <strong>apiserver</strong> ÂèëËµ∑ËØ∑Ê±ÇÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">echo</span> -n <span class="s2">&#34;{&#34;</span>kind<span class="s2">&#34;:&#34;</span>Secret<span class="s2">&#34;,&#34;</span>apiVersion<span class="s2">&#34;:&#34;</span>v1<span class="s2">&#34;,&#34;</span>metadata<span class="s2">&#34;:{&#34;</span>name<span class="s2">&#34;:&#34;</span>top-secret<span class="s2">&#34;,&#34;</span>namespace<span class="s2">&#34;:&#34;</span>default<span class="s2">&#34;,&#34;</span>creationTimestamp<span class="s2">&#34;:null},&#34;</span>data<span class="s2">&#34;:{&#34;</span>topsecret.txt<span class="s2">&#34;:&#34;</span><span class="nv">W1RPUCBTRUNSRVRdCg</span><span class="o">==</span><span class="s2">&#34;}}&#34;</span> <span class="p">|</span> http -A bearer -a eyJhbGciOiJSUzI1NiIsImtpZCI6IlZzVnlPVmlsTjg1eEZkdHFKWk1NVGxrcXBRQV9XWmdMQWZnNTFpZ1BveDgifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNjY3NTMwODQ4LCJpYXQiOjE2Njc1MjcyNDgsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImNpbGl1bSIsInVpZCI6IjMwMmIwMTU1LTY2MDgtNGI3MC1iZTRiLWY3ZmIyYmI3M2JlYiJ9fSwibmJmIjoxNjY3NTI3MjQ4LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpjaWxpdW0ifQ.T8Hekf2GGRBfBpKeKZsgyTYJvCEsRbG-cIydmi9lQR7YEzT-_2zhyIto8cDphnbhGSAnyjz8Ia2LruW2FAHawKMZdkTUbigCsnE0adUcri1-lHbV4SYI-PSXGvktnDsEpaauqDVa3AmlTn_o35UnqQDMNed5-5DIFWm3AcqWwZthriSuEH9j8HiaMRtV8-4YuwcVZyQ6bANUGkOsYd_IOHnt1ZT9fJ2mJnWvOjjO7xjcUjcD38DtClwRdTD7pY_BDONw1TashsjXcYNIeXk7n5fBHkENgUktS_3HyRP-whkX2Td-SghZTTYYd7cLhMVYKZL1-kBdi0Q9R4LhEjalvA  POST https://127.0.0.1:44257/api/v1/namespaces/default/secrets
</code></pre></td></tr></table>
</div>
</div><p>‰∏çËøáÊ≥®ÊÑèÂà∞Êàë‰ª¨Âπ∂Ê≤°Êúâ <code>create secret</code> ÁöÑÊùÉÈôêÔºåÊàë‰ª¨Ëã•Â∞ùËØï <code>create secret</code> Âàô‰ºöÊèêÁ§∫ 401 ÈîôËØØÁ†Å„ÄêÊú™ÊéàÊùÉÁöÑÊìç‰Ωú„ÄëÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">xxxxxxxxxx¬†HTTP/1.1 <span class="m">401</span> UnauthorizedAudit-Id: bdb8f7a5-84be-42b9-8d9b-8445c3bd3b85Cache-Control: no-cache, privateContent-Length: 129Content-Type: application/jsonDate: Fri, <span class="m">04</span> Nov <span class="m">2022</span> 11:09:15 GMT‚Äã<span class="o">{</span> ¬† ¬†<span class="s2">&#34;apiVersion&#34;</span>: <span class="s2">&#34;v1&#34;</span>, ¬† ¬†<span class="s2">&#34;code&#34;</span>: 401, ¬† ¬†<span class="s2">&#34;kind&#34;</span>: <span class="s2">&#34;Status&#34;</span>, ¬† ¬†<span class="s2">&#34;message&#34;</span>: <span class="s2">&#34;Unauthorized&#34;</span>, ¬† ¬†<span class="s2">&#34;metadata&#34;</span>: <span class="o">{}</span>, ¬† ¬†<span class="s2">&#34;reason&#34;</span>: <span class="s2">&#34;Unauthorized&#34;</span>, ¬† ¬†<span class="s2">&#34;status&#34;</span>: <span class="s2">&#34;Failure&#34;</span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>kubectl</strong> ‰ΩøÁî® <code>/path/to/home/.kube/config</code> Êñá‰ª∂‰∏≠ÁöÑÁî®Êà∑ÁßÅÈí•‰∏éËØÅ‰π¶Êù•‰∏é <strong>apiserver</strong> ËøõË°åÈÄö‰ø°ÔºåÂú®‰ΩøÁî® kind ÂàõÂª∫ÈõÜÁæ§Êó∂Ôºåkind-control-plane ‰∏≠ÁöÑ <code>/etc/kubernetes</code> ÁõÆÂΩï‰∏ãÊúâ <code>admin.conf</code> Êñá‰ª∂ÔºåÂÖ∂‰∏≠ÁöÑÁßÅÈí•‰∏éËØÅ‰π¶Ê≠£ÊòØÂú® <strong>kubectl</strong> ‰∏≠‰ΩøÁî®Âà∞ÁöÑÔºåkind ‰∏∫Êàë‰ª¨ÂáÜÂ§áÂ•Ω‰∫Ü‰∏ÄÂàáÔºÅ</p>
<ul>
<li>k9s ‰∏ãÈîÆÂÖ• groups ÂëΩ‰ª§ÔºåÂèØ‰ª•ÁúãÂà∞Âêç‰∏∫ system:master ÁöÑ <strong>ClusterRoleBinding</strong> ËµÑÊ∫êÂØπË±°ÔºåÂÖ∂Â∞Ü cluster-admin„ÄêClusterRole„ÄëÁªëÂÆöÂà∞‰∫Ü system:masters„ÄêGroup„Äë‰∏ä„ÄÇ</li>
<li>Âú® <code>/path/to/home/.kube/config</code> ‰∏≠ÁöÑÊï∞ÊçÆÁªèËøá‰∫Ü Base64 ÁºñÁ†ÅÔºåËß£Á†ÅÂêéÂèØ‰ª•ÂæóÂà∞ X509 Âà∂ÂºèÁöÑËØÅ‰π¶„ÄÇ</li>
</ul>
<blockquote>
<p>Kubernetes determines the username from the common name field in the &lsquo;subject&rsquo; of the cert (e.g., &ldquo;/CN=bob&rdquo;)</p>
</blockquote>
<p>Áªº‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® Openssl Ëß£ÊûêÁõ∏ÂÖ≥ËØÅ‰π¶ÔºåÊü•ÁúãÂÖ∂‰∏≠ÁöÑ <strong>Common Name Field</strong>Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨Âú® k8s ËØ≠‰πâ‰∏ãÊâÄËØ¥ÁöÑÁî®Êà∑ÂêçÔºàÊ≥®ÊÑèÔºöÂú® k8s ‰∏≠ÔºåÁî®Êà∑ÊâÄÂ±ûÁöÑÁªÑÂú®ËØÅ‰π¶‰∏≠Áî® <strong>Organization Field</strong> Ë°®Á§∫Ôºâ„ÄÇÂú® <code>config</code> Êñá‰ª∂ÊâÄÂú®ÁõÆÂΩï‰∏ãÊâßË°åÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">$cat</span> config <span class="p">|</span> grep -oP <span class="s2">&#34;(?&lt;=client-certificate-data: ).*&#34;</span> <span class="p">|</span> base64 -d &gt;&gt; kubernetes-admin.crt <span class="o">&amp;&amp;</span> openssl x509 -in kubernetes-admin.crt -text <span class="o">&amp;&amp;</span> rm kubernetes-admin.crt
</code></pre></td></tr></table>
</div>
</div><p>Êà™ÂèñËØÅ‰π¶‰∏≠ÁöÑÁõ∏ÂÖ≥ÂÜÖÂÆπÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"> Subject: O = system:masters, CN = kubernetes-admin
</code></pre></td></tr></table>
</div>
</div><p>ÂÖ∂‰∏≠ÔºåËØ•ËØÅ‰π¶‰ª£Ë°®ÁöÑ‚ÄúÁî®Êà∑Âêç‚Äù‰∏∫ kubernetes-adminÔºåÊâÄÂ±ûÁöÑ&quot;Áî®Êà∑ÁªÑ&quot;‰∏∫ system:mastersÔºåÊ†πÊçÆÊàë‰ª¨‰∏äËø∞ÁöÑÂàÜÊûêÂèØ‰ª•Áü•ÈÅì <strong>system:masters Group</strong> ‰∏é <strong>cluster-admin ClusterRole</strong> ÁªëÂÆöÔºå<strong>system:masters</strong> ‰∏≠ÁöÑÊàêÂëòÂÖ∑ÊúâÊìç‰ΩúÈõÜÁæ§‰∏≠ÊâÄÊúâËµÑÊ∫êÁöÑÊùÉÈôê„ÄÇ</p>
<p>Êàë‰ª¨Áü•ÈÅìÔºåk8s ‰∏≠Âπ∂Ê≤°Êúâ‰∏ìÈó®Áî®‰∫éÁª¥Êä§Áî®Êà∑Ë¥¶Êà∑ÁöÑÁªÑ‰ª∂ÔºåÂÖ∂Ëé∑ÂèñÁî®Êà∑Ë¥¶Êà∑ÁöÑÈÄîÂæÑÊòØÂú®ÈÄö‰ø°ÁöÑËøáÁ®ã‰∏≠ÈÄöËøáÂÆ¢Êà∑Á´ØËØÅ‰π¶‰ª•Âèä token Ëß£ÊûêÂêéÂØπÂ∫îÁöÑË¥¶Êà∑Â≠óÊÆµ‰ø°ÊÅØË°®Á§∫ÂΩìÂâçË∑ü <strong>apiserver</strong> ËøõË°åÈÄö‰ø°ÁöÑÂØπË±°ÔºåÂÖ∂‰ø°‰ªªÈÄö‰ø°ÂØπÁ≠âÊñπÊòØÂõ†‰∏∫ÂÖ∂Êèê‰æõÁöÑËÆ§ËØÅÂá≠ÊçÆÔºàÂÆ¢Êà∑Á´ØËØÅ‰π¶Áî± <strong>apiserver</strong> ÂêØÂä®Êó∂Êèê‰æõÁöÑ CA ÊâÄÁ≠æÂèë„ÄÅtoken Ê†°È™åÂêàÊ≥ïÔºâÂêàÊ≥ï„ÄÇÂ∞±Êãø <code>system:serviceaccount:default:cilium</code> ÁöÑ token (JWT) Êù•ÁúãÔºåÂÖ∂Âú®Ëß£ÊûêÂêéÂÖ∑ÊúâÂ¶Ç‰∏ã‰ø°ÊÅØÔºå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;aud&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&#34;https://kubernetes.default.svc.cluster.local&#34;</span>
  <span class="p">],</span>
  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1667530848</span><span class="p">,</span>
  <span class="nt">&#34;iat&#34;</span><span class="p">:</span> <span class="mi">1667527248</span><span class="p">,</span>
  <span class="nt">&#34;iss&#34;</span><span class="p">:</span> <span class="s2">&#34;https://kubernetes.default.svc.cluster.local&#34;</span><span class="p">,</span>
  <span class="nt">&#34;kubernetes.io&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;namespace&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
    <span class="nt">&#34;serviceaccount&#34;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;cilium&#34;</span><span class="p">,</span>
      <span class="nt">&#34;uid&#34;</span><span class="p">:</span> <span class="s2">&#34;302b0155-6608-4b70-be4b-f7fb2bb73beb&#34;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&#34;nbf&#34;</span><span class="p">:</span> <span class="mi">1667527248</span><span class="p">,</span>
  <span class="nt">&#34;sub&#34;</span><span class="p">:</span> <span class="s2">&#34;system:serviceaccount:default:cilium&#34;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>&ldquo;sub&rdquo;</strong> Â≠óÊÆµ‰æøÊ†áËØÜ‰∫ÜÂ∏¶ÊúâËØ• token ËØ∑Ê±ÇÁöÑ‰∏ª‰ΩìË∫´‰ªΩÔºå<strong>apiserver</strong> Ê†πÊçÆËØ•Ë∫´‰ªΩ‰ª•ÂèäÂÖ∂ËØ∑Ê±ÇÁöÑÁõ∏Â∫îËµÑÊ∫êÁªèËøáÊéàÊùÉÊ®°Âùó‰ª•ÂèäÂáÜÂÖ•ÊéßÂà∂Âô®Â§ÑÁêÜÂêéÂêëËØ∑Ê±Ç‰∏ª‰ΩìËøîÂõûÂìçÂ∫îÁªìÊûú„ÄÇ</p>
<blockquote>
<p>üåü <strong>Tips:</strong>
ÂÖ≥‰∫éÁî®Êà∑Ë∫´‰ªΩ‰∏ª‰ΩìÁöÑÂëΩÂêçËßÑÂàôÔºö&quot;<strong>system:serviceaccount</strong>&quot; ‰ª£Ë°®k8s‰∏≠ÁöÑËµÑÊ∫êÂØπË±°Ôºå&quot;<strong>default</strong>&quot; ‰ª£Ë°®ÂëΩÂêçÁ©∫Èó¥(namespace)Ôºå&quot;<strong>cilium</strong>&quot; ‰ª£Ë°®serviceaccountÁöÑÂëΩÂêç</p>
</blockquote>
<p>ServiceAccount-RoleBinding-ClusterRole Êìç‰Ωú‰ªçÁÑ∂‰ºöÈôêÂà∂Âú® <strong>ServiceAccount</strong> ÊâÄÂ§ÑÁöÑ Namespace ‰∏ãÔºåÊúÄÂ∞èÊùÉÈôê‰∫§ÈõÜÈõÜÂêà„ÄÇ</p>
<p>ServiceAccount-ClusterRoleBinding-ClusterRole ÂàôËÉΩÂ§üÂú®Êï¥‰∏™ÈõÜÁæ§ËåÉÂõ¥‰∏≠ÊâßË°å Role ÊâÄÊéàÊùÉÁöÑÊìç‰Ωú„ÄÇ</p>
<p>Role &amp; ClusterRole || RoleBinding &amp; ClusterRoleBinding „Äêsubject:(User, Group, ServiceAccount) object(roleRef):(Role)„Äë</p>
<p>‰ΩøÁî® kubectl ‰∏é apiServer ËøõË°å‰∫§‰∫íÊâßË°åÂëΩ‰ª§Êó∂ÔºåÂèëÂá∫ËØ∑Ê±ÇÊâÄ‰ΩøÁî®ÁöÑË∫´‰ªΩÊòØ User ÂÆû‰Ωì„ÄÇÂú®ÊàëÁöÑÂÆûÈ™åÁéØÂ¢É‰∏≠ÔºåÂàôÊòØÁî®Êà∑ kind-kind ÂÖ∂Âú® Cluster ‰∏≠ÁöÑ <strong>Role</strong> ÊòØ <strong>cluster-amdin</strong>ÔºåË¢´Ëµã‰∫à‰∫ÜËÉΩÂ§üÂØπÊâÄÊúâËµÑÊ∫êÊâßË°å‰ªªÊÑèÊìç‰ΩúÁöÑÊùÉÈôê„ÄÇkubectl Âä†ËΩΩÁöÑÈÖçÁΩÆÊñá‰ª∂ÈªòËÆ§‰Ωç‰∫é <code>/path/to/home/.kube</code> ‰∏ãÔºåÂÖ∂‰∏≠Â≠òÊúâ kind-kind Áî®Êà∑ÁöÑËØÅ‰π¶‰ª•ÂèäÁßÅÈí•‰ø°ÊÅØÔºåÁî®‰∫éËØÅÊòéÂÖ∂Ë∫´‰ªΩÔºå‰∏ãÈù¢Â±ïÁ§∫ÁöÑÊòØÁî®Êà∑kind-kindÁöÑËØÅ‰π¶ÔºåÂÖ∂‰∏≠Subject-OÂ≠óÊÆµ‰ª£Ë°®ÂÖ∂ÊâÄÂú®ÁöÑÁî®Êà∑ÁªÑÔºåSubject-CN‰ª£Ë°®ÂÖ∂Âú®k8sÁª¥Êä§ËµÑÊ∫ê‰∏≠ÁöÑÁî®Êà∑Âêç„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Version:          3 (0x02)
Serial number:    1041774366814885730 (0x0e7520445e1bd762)
Algorithm ID:     SHA256withRSA
Validity
  Not Before:     22/08/2023 03:12:59 (dd-mm-yyyy hh:mm:ss) (230822031259Z)
  Not After:      21/08/2024 03:18:00 (dd-mm-yyyy hh:mm:ss) (240821031800Z)
Issuer
  CN = kubernetes
Subject
  O  = system:masters
  CN = kubernetes-admin
Public Key
  Algorithm:      RSA
  Length:         2048 bits
  Modulus:        bf:a4:cf:72:34:07:a7:0c:4b:db:19:2a:f7:60:10:68:
                  8b:52:db:e9:3f:24:d5:05:c5:4b:c7:f5:04:1e:01:d4:
                  2a:e5:a5:59:4e:66:6f:25:eb:9f:1b:a5:91:81:28:18:
                  7f:a3:fd:36:c5:45:e5:ea:ef:18:a0:f8:61:1a:bc:6b:
                  ee:d5:18:5e:3a:08:c0:11:d4:62:3c:40:18:6f:e6:56:
                  49:fe:01:5b:c5:56:f2:ab:4e:db:9f:96:4e:2f:e3:26:
                  56:39:4b:e8:08:7d:e3:9c:15:01:be:86:8b:ce:b4:8e:
                  7e:b7:1f:f9:98:4d:fc:13:7a:0a:f5:d1:bf:11:c7:4d:
                  11:41:d5:14:92:4a:3e:ef:c9:03:07:58:5a:49:31:df:
                  c6:21:64:b6:5e:2e:1a:f8:da:4e:1a:7e:1b:7b:48:10:
                  9c:93:05:bd:a1:9e:f8:2c:75:0a:1a:4b:c6:1c:11:95:
                  de:9a:7f:dd:12:9e:94:7a:68:07:4d:19:ed:fb:63:26:
                  aa:a4:0a:71:81:83:a0:ad:94:e8:1e:7b:cc:dc:39:3c:
                  ca:ae:bf:ba:50:57:37:87:a4:e9:b7:b1:1c:27:0a:18:
                  18:51:5c:55:28:87:0a:18:12:35:99:14:c4:10:53:37:
                  26:2d:fa:69:7e:b2:d8:8d:f1:dc:76:83:01:a7:81:e5
  Exponent:       65537 (0x10001)
Certificate Signature
  Algorithm:      SHA256withRSA
  Signature:      92:d7:99:22:91:2f:f3:ef:38:25:b4:ad:ea:7d:2c:b7:
                  a1:bb:cf:a4:eb:a0:f8:86:b9:ea:2b:e8:39:0e:0d:3c:
                  27:72:19:33:a1:69:e6:72:6b:f0:82:9e:f1:44:e6:0a:
                  1d:9b:55:58:e6:79:75:84:af:65:d2:5c:30:8d:1f:0e:
                  25:18:62:5a:9f:7e:0a:20:79:da:29:be:bc:16:3d:d2:
                  4e:fa:0f:13:c2:9a:5a:bb:98:32:55:ae:a3:bf:36:db:
                  00:fc:db:6a:ef:7e:09:f2:8a:aa:22:ca:90:db:b8:15:
                  70:5d:b2:1b:b6:b9:37:93:52:8c:d9:92:0f:38:97:bb:
                  93:c7:90:19:e7:c1:41:29:2f:7f:b8:02:03:07:43:47:
                  0a:6d:bb:f5:1f:e5:42:e2:22:19:6e:dc:e1:8e:fb:49:
                  c2:43:69:1a:85:1e:9e:99:9e:e3:85:83:91:15:e3:9c:
                  b8:17:7d:83:65:db:c8:03:ee:4a:1e:75:98:66:2f:e7:
                  86:40:ea:71:17:b8:34:bc:a4:b9:48:4b:1f:a3:42:c1:
                  a2:e7:70:b7:0d:25:7d:af:16:40:63:49:fd:d1:85:67:
                  1f:2b:5a:4e:25:cc:b9:a6:99:4b:5c:03:c0:ad:3c:e8:
                  97:d1:6b:29:74:5e:5b:a0:99:f1:09:69:f9:d8:59:aa

Extensions
  keyUsage CRITICAL:
    digitalSignature,keyEncipherment
  extKeyUsage :
    clientAuth
  basicConstraints CRITICAL:
    {}
  authorityKeyIdentifier :
    kid=d2003d36621e663f31e8b164d33f6dbf9433c371

</code></pre></td></tr></table>
</div>
</div><h4 id="-security-issues-related-to-super-privilege-serviceaccount">üå† Security Issues Related to Super-Privilege Serviceaccount</h4>
<p>[1] <a href="https://unit42.paloaltonetworks.com/gke-autopilot-vulnerabilities/" target="_blank" rel="noopener noreffer ">GKE-Autopilot Vulnerabilities</a></p>
<p>[2] <a href="https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepapers/kubernetes-privilege-escalation-excessive-permissions-in-popular-platforms" target="_blank" rel="noopener noreffer ">Kubernetes Privilege Escalation Excessive Permissions in Popular Platforms</a></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Êõ¥Êñ∞‰∫é 2023-08-30</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/exploration-series-kubernetes-authenticationsa/index.md" target="_blank">ÈòÖËØªÂéüÂßãÊñáÊ°£</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="ÂàÜ‰∫´Âà∞ Twitter" data-sharer="twitter" data-url="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" data-title="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds" data-via="p1nant0m" data-hashtags="Kubernetes,Auth & Authz"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="ÂàÜ‰∫´Âà∞ Facebook" data-sharer="facebook" data-url="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" data-hashtag="Kubernetes"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="ÂàÜ‰∫´Âà∞ Hacker News" data-sharer="hackernews" data-url="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" data-title="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="ÂàÜ‰∫´Âà∞ Line" data-sharer="line" data-url="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" data-title="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="ÂàÜ‰∫´Âà∞ ÂæÆÂçö" data-sharer="weibo" data-url="https://p1nant0m.com/exploration-series-kubernetes-authenticationsa/" data-title="[‚ú®Exploration Series] Kubernetes Authentications &amp; Authorization Mechanismds"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/kubernetes/">kubernetes</a>,&nbsp;<a href="/tags/auth-authz/">Auth &amp; Authz</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">ËøîÂõû</a></span>&nbsp;|&nbsp;<span><a href="/">‰∏ªÈ°µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2023-07-16-hackthebox-busqueda/" class="prev" rel="prev" title="HacktheBox ÊâìÈù∂‰πãÊóÖÔºöbusqueda"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HacktheBox ÊâìÈù∂‰πãÊóÖÔºöbusqueda</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Áî± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.91.2">Hugo</a> Âº∫ÂäõÈ©±Âä® | ‰∏ªÈ¢ò - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">p1nant0m</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="ÂõûÂà∞È°∂ÈÉ®">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Êü•ÁúãËØÑËÆ∫">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"ÂêåÊÑè","link":"‰∫ÜËß£Êõ¥Â§ö","message":"Êú¨ÁΩëÁ´ô‰ΩøÁî® Cookies Êù•ÊîπÂñÑÊÇ®ÁöÑÊµèËßà‰ΩìÈ™å."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"üôÇP1nant0m","id-2":"üôÇP1nant0m"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"Ê≤°ÊúâÊâæÂà∞ÁªìÊûú","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
